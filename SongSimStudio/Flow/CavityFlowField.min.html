<!doctype html>
<html lang="en">
	<head>
		<meta charset="UTF-8">
		<title>TITLE</title>
		<script type="text/javascript">
function test_Complex(){var t=new Complex(1,1);console.log(t.getAngleCPLX());t.rotateCPLX(Math.PI/4);console.log(t.x,t.y)}var PointUtil=function(){};PointUtil.ORIGIN={x:0,y:0};PointUtil.Quadrant=function(t){if(t.x==0&&t.y==0)return 5;else if(t.x==0)return 6;else if(t.y==0)return 7;else if(t.x>0&&t.y>0)return 1;else if(t.x<0&&t.y>0)return 2;else if(t.x<0&&t.y<0)return 3;else if(t.x>0&&t.y<0)return 4};PointUtil.DistanceP2P=function(t,r){var i=t.x-r.x;var e=t.y-r.y;return Math.sqrt(i*i+e*e)};PointUtil.SlopeP2P=function(t,r){var i=0;if(Math.abs(t.x-r.x)<1e-10)i=1e10;else i=(r.y-t.y)/(r.x-t.x);return i};var LineUtil=function(){};LineUtil.InclinationAngelOfPoint=function(t,r){return this.InclinationAngle(PointUtil.ORIGIN,t,r)};LineUtil.InclinationAngle=function(t,r,i){var e=PointUtil.SlopeP2P(t,r);var n=Math.atan(e);var a=new Complex(r.x-t.x,r.y-t.y);var o=PointUtil.Quadrant(a);if(o==4||o==1)n=2*Math.PI+n;else if(o==2||o==3)n=Math.PI+n;else if(o==6){if(a.y>0)n=Math.PI/2;else n=Math.PI*3/2}else if(o==7){if(a.x>0)n=0;else n=Math.PI}else if(o==5)n=0;if(n>2*Math.PI)n-=2*Math.PI;if(i)return n;else return n*180/Math.PI};var ArcUtil=function(){};ArcUtil.SeparateArc=function(t,r,i,e){i*=Math.PI/180;var n=PointUtil.DistanceP2P(t,r)/2;var a=n/Math.sin(i/2);var o=new Complex(t.x,t.y);var l=new Complex((t.x+r.x)/2,(t.y+r.y)/2);var s=l.subCPLX(o);s.rotateCPLX((Math.PI-i)/2,a);var u=new Complex(s.x+o.x,s.y+o.y);s.rotateCPLX(Math.PI);var h=new Array;for(var c=new Complex,f=i/e,v=1;v<e;v++){s.rotateCPLX(f);c.x=s.x+u.x;c.y=s.y+u.y;h.push({x:c.x,y:c.y})}return h};var Complex=function(t,r){this.x=t;this.y=r;this.lengthCPLX=lengthCPLX;this.getAngleCPLX=getAngleCPLX;this.addCPLX=addCPLX;this.subCPLX=subCPLX;this.pole2cplx=pole2cplx;this.rotateCPLX=rotateCPLX};function lengthCPLX(){return Math.sqrt(this.x*this.x+this.y*this.y)}function getAngleCPLX(){return LineUtil.InclinationAngelOfPoint(this,true)}function addCPLX(t){this.x+=t.x;this.y+=t.y;return this}function subCPLX(t){this.x-=t.x;this.y-=t.y;return this}function pole2cplx(t,r){return new Complex(t*Math.cos(r),t*Math.sin(r))}function rotateCPLX(t,r){var i=this.getAngleCPLX()+t;var e=this.pole2cplx(r?r:this.lengthCPLX(),i);this.x=e.x;this.y=e.y;return this}function test_SolveByTDMA(){var t=new Array(0,1,2,2,3,4,4,5,6,6,7,8);var r=new Array(3,9,15,13);var i=[];var e=SolveByTDMA(4,t,r,i)}function idxA(t,r){return t*2+r-2}function idxL(t,r){return t+r-2}function idxU(t,r){return t-1}function idxb(t){return t-1}function idxz(t){return t-1}function SolveByTDMA(t,r,i,e){var n=0;var a=new Array(t*2-1);var o=new Array(t-1);var l=new Array(t);a[idxL(1,1)]=r[idxA(1,1)];o[idxU(1,2)]=r[idxA(1,2)]/a[idxL(1,1)];l[idxz(1)]=i[idxb(1)]/a[idxL(1,1)];for(n=2;n<t;n++){a[idxL(n,n-1)]=r[idxA(n,n-1)];a[idxL(n,n)]=r[idxA(n,n)]-a[idxL(n,n-1)]*o[idxU(n-1,n)];o[idxU(n,n+1)]=r[idxA(n,n+1)]/a[idxL(n,n)];l[idxz(n)]=(i[idxb(n)]-a[idxL(n,n-1)]*l[idxz(n-1)])/a[idxL(n,n)]}a[idxL(n,n-1)]=r[idxA(n,n-1)];a[idxL(n,n)]=r[idxA(n,n)]-a[idxL(n,n-1)]*o[idxU(n-1,n)];l[idxz(n)]=(i[idxb(n)]-a[idxL(n,n-1)]*l[idxz(n-1)])/a[idxL(n,n)];e[t-1]=l[t-1];for(n=t-1;n>0;n--){e[n-1]=l[idxz(n)]-o[idxU(n,n+1)]*e[n]}return getResidualTDMA(t,r,i,e)}function test_getResidualTDMA(){var t=4;var r=new Array(0,1,2,3,4,5,6,7,8,9,10,11);var i=new Array(5,21,34,28);var e=new Array(1+.01,2-.01,2+.03,1-.02);console.log("TDMA.Residual.Test:",getResidualTDMA(t,r,i,e))}function getResidualTDMA(t,r,i,e){var n=new Array(t),a=new Array(t);VectorUtil.ASSIGN(n,0);for(var o=1;o<=t;o++){for(var l=o-1;l<=o+1;l++){if(l<1)continue;if(l>t)continue;n[o-1]+=r[idxA(o,l)]*e[l-1]}n[o-1]-=i[o-1];a[o-1]=r[idxA(o,o)]*e[o-1]}return VectorUtil.NORMAL(n)/VectorUtil.NORMAL(a)}var MAX_ITERATIONS=15;function Romberg(t,r,i,e,n){if(r==i)return 0;if(n<=0)return Number.NaN;var a=[];var o=(i-r)/e;var l;a[0]=.5*(Number(t.call(this,r))+Number(t.call(this,i)));for(l=1;l<e;l++)a[0]+=Number(t.call(this,r+l*o));a[0]*=o;for(var s=1;s<MAX_ITERATIONS;s++){o/=2;var u=a[0];a[0]=a[s]=0;for(l=0;l<e;l++)a[0]+=Number(t.call(this,r+(2*l+1)*o));a[0]=.5*u+o*a[0];var h=1;for(l=1;l<=s;l++){h*=4;var c=a[l];a[l]=(h*a[l-1]-u)/(h-1);u=c}if(relativePrecision(Math.abs(a[s]-a[s-1]),a[s])<n){return a[s]}e*=2}return Number.NaN}function relativePrecision(t,r){return r>Number.MIN_VALUE?t/r:t}var pi_sqrt=Math.sqrt(Math.PI);function erfFun(t){return Math.exp(-t*t)}function erf(t){return 2/pi_sqrt*Romberg(erfFun,0,t,5,1e-5)}function erfc(t){return 1-erf(t)}function sinh(t){return.5*(Math.exp(t)-Math.exp(-t))}function cosh(t){return.5*(Math.exp(t)+Math.exp(-t))}function tanh(t){return(Math.exp(t)-Math.exp(-t))/(Math.exp(t)+Math.exp(-t))}var VectorUtil=function(){};VectorUtil.DOT=function(t,r){var i=0,e=t.length;for(var n=0;n<e;n++)i+=t[n]*r[n];return i};VectorUtil.ADD=function(t,r,i){var e=t.length;for(var n=0;n<e;n++)i[n]=t[n]+r[n]};VectorUtil.kADD=function(t,r,i,e){var n=t.length;for(var a=0;a<n;a++)e[a]=t[a]+i*r[a]};VectorUtil.SUB=function(t,r,i){var e=t.length;for(var n=0;n<e;n++)i[n]=t[n]-r[n]};VectorUtil.EQ=function(t,r){var i=t.length;for(var e=0;e<i;e++)t[e]=r[e]};VectorUtil.NORMAL=function(t){var r=0,i=t.length;for(var e=0;e<i;e++)r+=t[e]*t[e];return Math.sqrt(r)};VectorUtil.ASSIGN=function(t,r){var i=t.length;for(var e=0;e<i;e++)t[e]=r};VectorUtil.SHUFFLE=function(t,r,i){if(r>i){var e=r;r=i;i=e}var n=t.length;for(var a=0;a<n;a++)t[a]=(i-r)*Math.random()+r};VectorUtil.MAX=function(t){var r=t.length,i=Number.MIN_VALUE;for(var e=0;e<r;e++)if(t[e]>i)i=t[e];return i};VectorUtil.MIN=function(t){var r=t.length,i=Number.MAX_VALUE;for(var e=0;e<r;e++)if(t[e]<i)i=t[e];return i};var Aij=function(){this.col=0;this.value=0;this.next=null};var SparseMatrix=function(t){this.epsilon=t||1e-10;this.dim=0;this.dataBin=null;this.Create=Create;this.Erase=Erase;this.get=get;this.set=set;this.ShowSparseMatrix=ShowSparseMatrix;this.MULaVector=MULaVector;this.MULaVectorT=MULaVectorT;this.SolveZ=SolveZ;this.SolveZZ=SolveZ;this.getResidue=getResidue;this.SolveByCG=SolveByCG};function Create(t,r){this.dim=t;this.dataBin=new Array(t);for(var i=0;i<t;i++){var e=new Aij;e.col=i;e.value=0;this.dataBin[i]=e}this.solved=r;this.p=new Array(t);this.pp=new Array(t);this.r=new Array(t);this.rr=new Array(t);this.z=new Array(t);this.zz=new Array(t)}function Erase(t){t=t||0;for(var r,i=0;i<this.dim;i++){r=this.dataBin[i];r.col=i;r.value=t;r.next=null}}function set(t,r,i){if(Math.abs(i)<this.epsilon)return;if(t>=this.dim||t<0)return;if(r>=this.dim||r<0)return;var e=this.dataBin[t],n;if(this.solved&&this.solved[t]){e.value=1;return}if(r<e.col){var a=new Aij;a.col=r;a.value=i;a.next=e;this.dataBin[t]=a;return}while(e.col<r&&e.next!=null){n=e;e=e.next}if(e.col==r){e.value=i;return}var o=new Aij;if(e.next==null&&r>e.col){e.next=o;o.col=r;o.value=i}else{n.next=o;o.next=e;o.col=r;o.value=i}return}function get(t,r){var i=this.dataBin[t];while(i.col<r&&i.next!=null)i=i.next;if(i.col==r)return i.value;return 0}function ShowSparseMatrix(t){for(var r=0;r<this.dim;r++){var i=this.dataBin[r];var e="";while(i!=null){e+="A["+r+","+i.col+"]="+i.value+";";i=i.next}if(t)e+="b="+t[r];console.log(e)}}function MULaVector(t,r){for(var i=0;i<this.dim;i++)r[i]=0;for(var e=0;e<this.dim;e++){var n=this.dataBin[e];while(n!=null){r[e]+=n.value*t[n.col];n=n.next}}}function MULaVectorT(t,r){for(var i=0;i<this.dim;i++)r[i]=0;for(var e=0;e<this.dim;e++){var n=this.dataBin[e];while(n!=null){r[n.col]+=n.value*t[e];n=n.next}}}function SolveZ(t,r,i){var e=0;for(var n=0;n<this.dim;n++){e=this.get(n,n);r[n]=t[n]/e}}function getResidue(t,r,i){this.MULaVector(t,i);VectorUtil.SUB(r,i,i)}function SolveByCG(t,r,i,e){var n,a,o,l=1,s,u;var h=t.length,c=0;e=e||h+1;var f=this.p;var v=this.pp;var x=this.r;var d=this.rr;var A=this.z;var M=this.zz;var U=false;this.getResidue(r,t,x);VectorUtil.EQ(d,x);while(c<e){++c;this.SolveZ(x,A,0);this.SolveZZ(d,M,1);s=VectorUtil.DOT(A,d);if(c==1){VectorUtil.EQ(f,A);VectorUtil.EQ(v,M)}else{o=s/l;VectorUtil.kADD(A,f,o,f);VectorUtil.kADD(M,v,o,v)}l=s;this.MULaVector(f,A);a=VectorUtil.DOT(A,v);n=s/a;this.MULaVectorT(v,M);VectorUtil.kADD(r,f,n,r);VectorUtil.kADD(x,A,-n,x);VectorUtil.kADD(d,M,-n,d);var L=VectorUtil.NORMAL(t);L=L>0?L:1;u=VectorUtil.NORMAL(x)/L;if(u<=i)return u}}function findRootByIterative(t,r,i,e){var n;i=i||1e-6;e=e||25;for(var a=0;a<e;a++){n=t(r);console.log(n,r);if(Math.abs(n-r)<i)return n;else r=n}}
var EPSILON=1e-6;function GetCanvasContext(t,e){var r=document.getElementById(t);return r.getContext("2d")}function TraceLog(t,e){var r=document.createElement("div");r.innerHTML=e;document.getElementById(t).appendChild(r)}function QueryPara(t){var e=new RegExp("(^|&)"+t+"=([^&]*)(&|$)");var r=window.location.search.substr(1).match(e);if(r!=null)return unescape(r[2]);return null}function AssembledChartData(t,e,r,n){n=n||["red","blue","green","aqua","lime"];var o={};o.labels=t;o.datasets=[];var a=e.length;for(var i=0;i<a;i++){var l={};l.label=r[i];l.fillColor="transparent";l.strokeColor=n[i];l.pointColor=n[i];l.pointStrokeColor="#fff";l.pointHighlightFill="#fff";l.pointHighlightStroke="rgba(220,220,220,1)";l.data=e[i];o.datasets.push(l)}return o}function XYZ(t,e,r){this.x=t;this.y=e;this.z=r}function Elem(t,e){this.p=t;this.tag=e}var MathUtil=function(){};MathUtil.NumberContain=function(t,e,r,n){if(t==r){if(n)return true;else return false}var o=(e-t)/(t-r);if(o==0){if(n)return true;else return false}if(o>0)return true;else return false};MathUtil.InterpolatePoint=function(t,e,r){var n=new XYZ(e.x-t.x,e.y-t.y,0);var o=t.x+n.x*(1-r);var a=t.y+n.y*(1-r);var i=e.z+r*(t.z-e.z);var l=new XYZ(o,a,i);return l};MathUtil.lineContainValues=function(t,e,r){var n=[];if(r==null||!r.length)return n;if(t.z==e.z)return n;for(var o=0;o<r.length;o++){var a=(r[o]-e.z)/(t.z-e.z);if(MathUtil.NumberContain(a,0,1,false)){n.push(MathUtil.InterpolatePoint(t,e,a))}}return n};var ColorUtil=new function(){};ColorUtil.combineRGB=function(t,e,r){return"rgb("+t+","+e+","+r+")"};ColorUtil.getLegendColor=function(t){var e=[];for(var r=0;r<=t;r++){var n=r/t;if(n<=.25)e[r]=ColorUtil.colorInR1(n);else if(n<=.5)e[r]=ColorUtil.colorInR2(n);else if(n<=.75)e[r]=ColorUtil.colorInR3(n);else e[r]=ColorUtil.colorInR4(n)}return e.reverse()};ColorUtil.colorInR1=function(t){t/=.25;return ColorUtil.combineRGB(255,Math.floor(t*255),0)};ColorUtil.colorInR2=function(t){t=(t-.25)/.25;return ColorUtil.combineRGB(Math.floor((1-t)*255),255,0)};ColorUtil.colorInR3=function(t){t=(t-.5)/.25;return ColorUtil.combineRGB(0,255,Math.floor(t*255))};ColorUtil.colorInR4=function(t){t=(t-.75)/.25;return ColorUtil.combineRGB(0,Math.floor((1-t)*255),255)};ColorUtil.GetCColor=function(t,e,r){if(t<=r[0])return e[0];else if(t>=r[r.length-1])return e[e.length-1];for(var n=0;n<r.length-1;n++){if(MathUtil.NumberContain(t,r[n],r[n+1]))return e[n+1]}return 0};var ContourUtil=new function(){};ContourUtil.triangleMode=function(t,e){if(e.length==0)return 0;var r=0,n=0;var o=e[0].z;var a=0;if(e.length==1){for(var i=0;i<t.length;i++){if(t[i].z<o)n++}return n}a=e[e.length-1].z;for(var l=0;l<t.length;l++){if(t[l].z>a)r++;if(t[l].z<o)n++}if(n==r)return 3;else return n};ContourUtil.DrawPath=function(t,e,r,n){t.fillStyle=r;t.beginPath();t.moveTo(e[0],e[1]);for(var o=2;o<e.length-1;o+=2){t.lineTo(e[o],e[o+1])}t.closePath();t.fill();if(n)t.stroke()};ContourUtil.SpawnValueKey=function(t,e){var r=Number.NEGATIVE_INFINITY;var n=Number.POSITIVE_INFINITY;t.forEach(function(t){if(t.z>r)r=t.z;if(t.z<n)n=t.z});console.log("(value key) max:",r,"/min:",n);var o=r-n;r-=o*.05;n+=o*.05;o=r-n;if(e<2)e=2;var a=o/e;var i=new Array;for(var l=0;l<=e;l++){i.push(n+l*a)}return i};ContourUtil.DrawLegend=function(t,e,r){r=r||2;var n=ColorUtil.getLegendColor(e.length);t.strokeStyle="#000000";t.lineWidth=1;var o=n.length;for(var a=0;a<o;a++){t.fillStyle=n[o-a-1];t.fillRect(0,16*a,20,16);t.strokeRect(0,16*a,20,16)}t.font="16px Georgia";t.fillStyle="#000000";o=e.length;for(var a=0;a<o;a++){t.fillText(e[o-a-1].toFixed(r),25,16*a+20)}};ContourUtil.DrawDelta=function(t,e,r,n,o,a){var i=MathUtil.lineContainValues(e[0],e[2],o);var l=MathUtil.lineContainValues(e[0],e[1],o);for(var u=0;u<i.length;u++){if(Math.abs(i[u].z-e[1].z)<EPSILON){l.push(e[1]);break}}var h=MathUtil.lineContainValues(e[1],e[2],o);if(l!=null){if(h!=null&&h.length){for(var s=0;s<h.length;s++)l.push(h[s])}}else{l=h}h=null;var f=ContourUtil.triangleMode(e,i);if(f==0){i.push(e[0]);l.push(e[0]);i.push(e[2]);l.push(e[1])}else if(f==1){i.unshift(e[0]);l.unshift(e[0]);i.push(e[2]);l.push(e[1])}else if(f==2){i.unshift(e[0]);l.unshift(e[1]);i.push(e[2]);l.push(e[2])}else if(f==3){i.unshift(e[0]);l.unshift(e[0]);i.push(e[2]);l.push(e[2])}if(i.length!=l.length)return;for(var c,v=0;v<i.length-1;v++){var C=[];c=r(i[v]);C.push(c.x,c.y);c=r(l[v]);C.push(c.x,c.y);if(f==3){if(MathUtil.NumberContain(e[1].z,l[v].z,l[v+1].z,false)){c=r(e[1]);C.push(c.x,c.y)}}c=r(l[v+1]);C.push(c.x,c.y);c=r(i[v+1]);C.push(c.x,c.y);c=r(i[v]);C.push(c.x,c.y);var y=ColorUtil.GetCColor((i[v].z+i[v+1].z)/2,n,o);ContourUtil.DrawPath(t,C,y,a)}};ContourUtil.DrawAll=function(r,n,t,o,a,i,l){var u=new Array(3);t.forEach(function(t){for(var e=0;e<3;e++){u[e]=n[t.p[e]]}u.sort(function(t,e){return t.z-e.z});ContourUtil.DrawDelta(r,u,o,a,i,l)})};ContourUtil.ShowCoordnates=function(t,e,r,n,o,a){o=o||5;a=a||5;t.strokeStyle="#000000";t.lineWidth=1;var i=new XYZ(0,0,0);t.beginPath();i=e(i);t.moveTo(i.x,i.y);i.x=r*1.2;i.y=0;i=e(i);t.lineTo(i.x,i.y);i.x=0;i.y=0;i=e(i);t.moveTo(i.x,i.y);i.x=0;i.y=n*1.2;i=e(i);t.lineTo(i.x,i.y);t.stroke();t.font="16px Georgia";t.fillStyle="#000000";var l=0;var u="a string";for(var h=0;h<=o;h++){i.x=h*r/o;i.y=0;i=e(i);t.beginPath();t.arc(i.x,i.y,3,0,360,false);t.fill();t.closePath();l=h*r/o;u=l.toFixed(2);t.fillText(u,i.x,i.y+20)}for(var h=0;h<=a;h++){i.x=0;i.y=h*n/a;i=e(i);t.beginPath();t.arc(i.x,i.y,3,0,360,false);t.fill();t.closePath();l=h*n/a;u=l.toFixed(2);t.fillText(u,i.x-40,i.y)}};var arrowAngel=15*Math.PI/180;ContourUtil.DrawArrow=function(t,e,r){t.strokeStyle="#000000";t.lineWidth=1;var n=r.lengthCPLX();theta=Math.PI+arrowAngel;var o=new Complex(r.x,r.y);r.addCPLX(e);var a=new Complex(r.x,r.y);t.moveTo(e.x,e.y);t.lineTo(r.x,r.y);var i=n*.2;o.rotateCPLX(theta,i);r.addCPLX(o);t.lineTo(r.x,r.y);t.moveTo(a.x,a.y);o.rotateCPLX(-arrowAngel*2);a.addCPLX(o);t.lineTo(a.x,a.y);t.stroke()};function spawnTestData(t,e){return t+(e-t)*Math.random()}var ResidualMonitor=function(t,e,r){this.type=e||"Flow2D";this.maxData=r||50;this.ctx=GetCanvasContext(t);this.xData=new Array;this.yData=new Array;this.yData[0]=new Array;this.yData[1]=new Array;this.yData[2]=new Array;this.tags=["Velocity","Pressure","Continuity"];if(this.type=="Flow2D"){this.yData[3]=new Array;this.tags=["X-Velocity","Y-Velocity","Pressure","Continuity"]}this.chartData=AssembledChartData(this.xData,this.yData,this.tags);this.chart=new Chart(this.ctx).Line(this.chartData,{responsive:true,xLabelsSkip:50,bezierCurve:false});this.AddNewRes=AddNewRes;this.ShowLegend=ShowLegend};function AddNewRes(t,e){if(this.chart.datasets[0].length>this.maxData){this.chart.removeData()}this.chart.addData(t,e)}function ShowLegend(t){var e=this.chart.generateLegend();var t=document.getElementById(t);t.innerHTML=e}
(function(){"use strict";var t=this,i=t.Chart;var a=function(t){var i=this;this.canvas=t.canvas;this.ctx=t;var e=function(t,i){if(t["offset"+i]){return t["offset"+i]}else{return document.defaultView.getComputedStyle(t).getPropertyValue(i)}};var s=this.width=e(t.canvas,"Width")||t.canvas.width;var n=this.height=e(t.canvas,"Height")||t.canvas.height;s=this.width=t.canvas.width;n=this.height=t.canvas.height;this.aspectRatio=this.width/this.height;d.retinaScale(this);return this};a.defaults={global:{animation:true,animationSteps:60,animationEasing:"easeOutQuart",showScale:true,scaleOverride:false,scaleSteps:null,scaleStepWidth:null,scaleStartValue:null,scaleLineColor:"rgba(0,0,0,.1)",scaleLineWidth:1,scaleShowLabels:true,scaleLabel:"<%=value%>",scaleIntegersOnly:true,scaleBeginAtZero:false,scaleFontFamily:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",scaleFontSize:12,scaleFontStyle:"normal",scaleFontColor:"#666",responsive:false,xLabelsSkip:1,maintainAspectRatio:true,showTooltips:true,customTooltips:false,tooltipEvents:["mousemove","touchstart","touchmove","mouseout"],tooltipFillColor:"rgba(0,0,0,0.8)",tooltipFontFamily:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",tooltipFontSize:14,tooltipFontStyle:"normal",tooltipFontColor:"#fff",tooltipTitleFontFamily:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",tooltipTitleFontSize:14,tooltipTitleFontStyle:"bold",tooltipTitleFontColor:"#fff",tooltipTitleTemplate:"<%= label%>",tooltipYPadding:6,tooltipXPadding:6,tooltipCaretSize:8,tooltipCornerRadius:6,tooltipXOffset:10,tooltipTemplate:"<%if (label){%><%=label%>: <%}%><%= value %>",multiTooltipTemplate:"<%= datasetLabel %>: <%= value %>",multiTooltipKeyBackground:"#fff",segmentColorDefault:["#A6CEE3","#1F78B4","#B2DF8A","#33A02C","#FB9A99","#E31A1C","#FDBF6F","#FF7F00","#CAB2D6","#6A3D9A","#B4B482","#B15928"],segmentHighlightColorDefaults:["#CEF6FF","#47A0DC","#DAFFB2","#5BC854","#FFC2C1","#FF4244","#FFE797","#FFA728","#F2DAFE","#9265C2","#DCDCAA","#D98150"],onAnimationProgress:function(){},onAnimationComplete:function(){}}};a.types={};var d=a.helpers={};var S=d.each=function(t,i,e){var s=Array.prototype.slice.call(arguments,3);if(t){if(t.length===+t.length){var n;for(n=0;n<t.length;n++){i.apply(e,[t[n],n].concat(s))}}else{for(var o in t){i.apply(e,[t[o],o].concat(s))}}}},o=d.clone=function(e){var s={};S(e,function(t,i){if(e.hasOwnProperty(i)){s[i]=t}});return s},h=d.extend=function(s){S(Array.prototype.slice.call(arguments,1),function(e){S(e,function(t,i){if(e.hasOwnProperty(i)){s[i]=t}})});return s},l=d.merge=function(t,i){var e=Array.prototype.slice.call(arguments,0);e.unshift({});return h.apply(null,e)},f=d.indexOf=function(t,i){if(Array.prototype.indexOf){return t.indexOf(i)}else{for(var e=0;e<t.length;e++){if(t[e]===i)return e}return-1}},e=d.where=function(t,i){var e=[];d.each(t,function(t){if(i(t)){e.push(t)}});return e},s=d.findNextWhere=function(t,i,e){if(!e){e=-1}for(var s=e+1;s<t.length;s++){var n=t[s];if(i(n)){return n}}},n=d.findPreviousWhere=function(t,i,e){if(!e){e=t.length}for(var s=e-1;s>=0;s--){var n=t[s];if(i(n)){return n}}},r=d.inherits=function(t){var i=this;var e=t&&t.hasOwnProperty("constructor")?t.constructor:function(){return i.apply(this,arguments)};var s=function(){this.constructor=e};s.prototype=i.prototype;e.prototype=new s;e.extend=r;if(t)h(e.prototype,t);e.__super__=i.prototype;return e},c=d.noop=function(){},u=d.uid=function(){var t=0;return function(){return"chart-"+t++}}(),p=d.warn=function(t){if(window.console&&typeof window.console.warn==="function")console.warn(t)},g=d.amd=typeof define==="function"&&define.amd,m=d.isNumber=function(t){return!isNaN(parseFloat(t))&&isFinite(t)},x=d.max=function(t){return Math.max.apply(Math,t)},y=d.min=function(t){return Math.min.apply(Math,t)},v=d.cap=function(t,i,e){if(m(i)){if(t>i){return i}}else if(m(e)){if(t<e){return e}}return t},C=d.getDecimalPlaces=function(t){if(t%1!==0&&m(t)){var i=t.toString();if(i.indexOf("e-")<0){return i.split(".")[1].length}else if(i.indexOf(".")<0){return parseInt(i.split("e-")[1])}else{var e=i.split(".")[1].split("e-");return e[0].length+parseInt(e[1])}}else{return 0}},b=d.radians=function(t){return t*(Math.PI/180)},w=d.getAngleFromPoint=function(t,i){var e=i.x-t.x,s=i.y-t.y,n=Math.sqrt(e*e+s*s);var o=Math.PI*2+Math.atan2(s,e);if(e<0&&s<0){o+=Math.PI*2}return{angle:o,distance:n}},P=d.aliasPixel=function(t){return t%2===0?0:.5},L=d.splineCurve=function(t,i,e,s){var n=Math.sqrt(Math.pow(i.x-t.x,2)+Math.pow(i.y-t.y,2)),o=Math.sqrt(Math.pow(e.x-i.x,2)+Math.pow(e.y-i.y,2)),a=s*n/(n+o),h=s*o/(n+o);return{inner:{x:i.x-a*(e.x-t.x),y:i.y-a*(e.y-t.y)},outer:{x:i.x+h*(e.x-t.x),y:i.y+h*(e.y-t.y)}}},k=d.calculateOrderOfMagnitude=function(t){return Math.floor(Math.log(t)/Math.LN10)},F=d.calculateScaleRange=function(t,i,e,s,n){var o=2,a=Math.floor(i/(e*1.5)),h=o>=a;var l=[];S(t,function(t){t==null||l.push(t)});var r=y(l),c=x(l);if(c===r){c+=.5;if(r>=.5&&!s){r-=.5}else{c+=.5}}var u=Math.abs(c-r),d=k(u),f=Math.ceil(c/(1*Math.pow(10,d)))*Math.pow(10,d),p=s?0:Math.floor(r/(1*Math.pow(10,d)))*Math.pow(10,d),g=f-p,m=Math.pow(10,d),v=Math.round(g/m);while((v>a||v*2<a)&&!h){if(v>a){m*=2;v=Math.round(g/m);if(v%1!==0){h=true}}else{if(n&&d>=0){if(m/2%1===0){m/=2;v=Math.round(g/m)}else{break}}else{m/=2;v=Math.round(g/m)}}}if(h){v=o;m=g/v}return{steps:v,stepValue:m,min:p,max:p+v*m}},A=d.template=function(t,i){if(t instanceof Function){return t(i)}var s={};function e(t,i){var e=!/\W/.test(t)?s[t]=s[t]:new Function("obj","var p=[],print=function(){p.push.apply(p,arguments);};"+"with(obj){p.push('"+t.replace(/[\r\t\n]/g," ").split("<%").join("\t").replace(/((^|%>)[^\t]*)'/g,"$1\r").replace(/\t=(.*?)%>/g,"',$1,'").split("\t").join("');").split("%>").join("p.push('").split("\r").join("\\'")+"');}return p.join('');");return i?e(i):e}return e(t,i)},R=d.generateLabels=function(e,t,s,n){var o=new Array(t);if(e){S(o,function(t,i){o[i]=A(e,{value:s+n*(i+1)})})}return o},T=d.easingEffects={linear:function(t){return t},easeInQuad:function(t){return t*t},easeOutQuad:function(t){return-1*t*(t-2)},easeInOutQuad:function(t){if((t/=1/2)<1){return 1/2*t*t}return-1/2*(--t*(t-2)-1)},easeInCubic:function(t){return t*t*t},easeOutCubic:function(t){return 1*((t=t/1-1)*t*t+1)},easeInOutCubic:function(t){if((t/=1/2)<1){return 1/2*t*t*t}return 1/2*((t-=2)*t*t+2)},easeInQuart:function(t){return t*t*t*t},easeOutQuart:function(t){return-1*((t=t/1-1)*t*t*t-1)},easeInOutQuart:function(t){if((t/=1/2)<1){return 1/2*t*t*t*t}return-1/2*((t-=2)*t*t*t-2)},easeInQuint:function(t){return 1*(t/=1)*t*t*t*t},easeOutQuint:function(t){return 1*((t=t/1-1)*t*t*t*t+1)},easeInOutQuint:function(t){if((t/=1/2)<1){return 1/2*t*t*t*t*t}return 1/2*((t-=2)*t*t*t*t+2)},easeInSine:function(t){return-1*Math.cos(t/1*(Math.PI/2))+1},easeOutSine:function(t){return 1*Math.sin(t/1*(Math.PI/2))},easeInOutSine:function(t){return-1/2*(Math.cos(Math.PI*t/1)-1)},easeInExpo:function(t){return t===0?1:1*Math.pow(2,10*(t/1-1))},easeOutExpo:function(t){return t===1?1:1*(-Math.pow(2,-10*t/1)+1)},easeInOutExpo:function(t){if(t===0){return 0}if(t===1){return 1}if((t/=1/2)<1){return 1/2*Math.pow(2,10*(t-1))}return 1/2*(-Math.pow(2,-10*--t)+2)},easeInCirc:function(t){if(t>=1){return t}return-1*(Math.sqrt(1-(t/=1)*t)-1)},easeOutCirc:function(t){return 1*Math.sqrt(1-(t=t/1-1)*t)},easeInOutCirc:function(t){if((t/=1/2)<1){return-1/2*(Math.sqrt(1-t*t)-1)}return 1/2*(Math.sqrt(1-(t-=2)*t)+1)},easeInElastic:function(t){var i=1.70158;var e=0;var s=1;if(t===0){return 0}if((t/=1)==1){return 1}if(!e){e=1*.3}if(s<Math.abs(1)){s=1;i=e/4}else{i=e/(2*Math.PI)*Math.asin(1/s)}return-(s*Math.pow(2,10*(t-=1))*Math.sin((t*1-i)*(2*Math.PI)/e))},easeOutElastic:function(t){var i=1.70158;var e=0;var s=1;if(t===0){return 0}if((t/=1)==1){return 1}if(!e){e=1*.3}if(s<Math.abs(1)){s=1;i=e/4}else{i=e/(2*Math.PI)*Math.asin(1/s)}return s*Math.pow(2,-10*t)*Math.sin((t*1-i)*(2*Math.PI)/e)+1},easeInOutElastic:function(t){var i=1.70158;var e=0;var s=1;if(t===0){return 0}if((t/=1/2)==2){return 1}if(!e){e=1*(.3*1.5)}if(s<Math.abs(1)){s=1;i=e/4}else{i=e/(2*Math.PI)*Math.asin(1/s)}if(t<1){return-.5*(s*Math.pow(2,10*(t-=1))*Math.sin((t*1-i)*(2*Math.PI)/e))}return s*Math.pow(2,-10*(t-=1))*Math.sin((t*1-i)*(2*Math.PI)/e)*.5+1},easeInBack:function(t){var i=1.70158;return 1*(t/=1)*t*((i+1)*t-i)},easeOutBack:function(t){var i=1.70158;return 1*((t=t/1-1)*t*((i+1)*t+i)+1)},easeInOutBack:function(t){var i=1.70158;if((t/=1/2)<1){return 1/2*(t*t*(((i*=1.525)+1)*t-i))}return 1/2*((t-=2)*t*(((i*=1.525)+1)*t+i)+2)},easeInBounce:function(t){return 1-T.easeOutBounce(1-t)},easeOutBounce:function(t){if((t/=1)<1/2.75){return 1*(7.5625*t*t)}else if(t<2/2.75){return 1*(7.5625*(t-=1.5/2.75)*t+.75)}else if(t<2.5/2.75){return 1*(7.5625*(t-=2.25/2.75)*t+.9375)}else{return 1*(7.5625*(t-=2.625/2.75)*t+.984375)}},easeInOutBounce:function(t){if(t<1/2){return T.easeInBounce(t*2)*.5}return T.easeOutBounce(t*2-1)*.5+1*.5}},M=d.requestAnimFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(t){return window.setTimeout(t,1e3/60)}}(),W=d.cancelAnimFrame=function(){return window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||window.oCancelAnimationFrame||window.msCancelAnimationFrame||function(t){return window.clearTimeout(t,1e3/60)}}(),z=d.animationLoop=function(e,s,t,n,o,a){var h=0,l=T[t]||T.linear;var r=function(){h++;var t=h/s;var i=l(t);e.call(a,i,t,h);n.call(a,i,t);if(h<s){a.animationFrame=M(r)}else{o.apply(a)}};M(r)},B=d.getRelativePosition=function(t){var i,e;var s=t.originalEvent||t,n=t.currentTarget||t.srcElement,o=n.getBoundingClientRect();if(s.touches){i=s.touches[0].clientX-o.left;e=s.touches[0].clientY-o.top}else{i=s.clientX-o.left;e=s.clientY-o.top}return{x:i,y:e}},O=d.addEvent=function(t,i,e){if(t.addEventListener){t.addEventListener(i,e)}else if(t.attachEvent){t.attachEvent("on"+i,e)}else{t["on"+i]=e}},I=d.removeEvent=function(t,i,e){if(t.removeEventListener){t.removeEventListener(i,e,false)}else if(t.detachEvent){t.detachEvent("on"+i,e)}else{t["on"+i]=c}},E=d.bindEvents=function(i,t,e){if(!i.events)i.events={};S(t,function(t){i.events[t]=function(){e.apply(i,arguments)};O(i.chart.canvas,t,i.events[t])})},D=d.unbindEvents=function(e,t){S(t,function(t,i){I(e.chart.canvas,i,t)})},H=d.getMaximumWidth=function(t){var i=t.parentNode,e=parseInt(X(i,"padding-left"))+parseInt(X(i,"padding-right"));return i?i.clientWidth-e:0},V=d.getMaximumHeight=function(t){var i=t.parentNode,e=parseInt(X(i,"padding-bottom"))+parseInt(X(i,"padding-top"));return i?i.clientHeight-e:0},X=d.getStyle=function(t,i){return t.currentStyle?t.currentStyle[i]:document.defaultView.getComputedStyle(t,null).getPropertyValue(i)},Y=d.getMaximumSize=d.getMaximumWidth,G=d.retinaScale=function(t){var i=t.ctx,e=t.canvas.width,s=t.canvas.height;if(window.devicePixelRatio){i.canvas.style.width=e+"px";i.canvas.style.height=s+"px";i.canvas.height=s*window.devicePixelRatio;i.canvas.width=e*window.devicePixelRatio;i.scale(window.devicePixelRatio,window.devicePixelRatio)}},j=d.clear=function(t){t.ctx.clearRect(0,0,t.width,t.height)},q=d.fontString=function(t,i,e){return i+" "+t+"px "+e},N=d.longestText=function(e,t,i){e.font=t;var s=0;S(i,function(t){var i=e.measureText(t).width;s=i>s?i:s});return s},_=d.drawRoundedRectangle=function(t,i,e,s,n,o){t.beginPath();t.moveTo(i+o,e);t.lineTo(i+s-o,e);t.quadraticCurveTo(i+s,e,i+s,e+o);t.lineTo(i+s,e+n-o);t.quadraticCurveTo(i+s,e+n,i+s-o,e+n);t.lineTo(i+o,e+n);t.quadraticCurveTo(i,e+n,i,e+n-o);t.lineTo(i,e+o);t.quadraticCurveTo(i,e,i+o,e);t.closePath()};a.instances={};a.Type=function(t,i,e){this.options=i;this.chart=e;this.id=u();a.instances[this.id]=this;if(i.responsive){this.resize()}this.initialize.call(this,t)};h(a.Type.prototype,{initialize:function(){return this},clear:function(){j(this.chart);return this},stop:function(){a.animationService.cancelAnimation(this);return this},resize:function(t){this.stop();var i=this.chart.canvas,e=H(this.chart.canvas),s=this.options.maintainAspectRatio?e/this.chart.aspectRatio:V(this.chart.canvas);i.width=this.chart.width=e;i.height=this.chart.height=s;G(this.chart);if(typeof t==="function"){t.apply(this,Array.prototype.slice.call(arguments,1))}return this},reflow:c,render:function(t){if(t){this.reflow()}if(this.options.animation&&!t){var i=new a.Animation;i.numSteps=this.options.animationSteps;i.easing=this.options.animationEasing;i.render=function(t,i){var e=d.easingEffects[i.easing];var s=i.currentStep/i.numSteps;var n=e(s);t.draw(n,s,i.currentStep)};i.onAnimationProgress=this.options.onAnimationProgress;i.onAnimationComplete=this.options.onAnimationComplete;a.animationService.addAnimation(this,i)}else{this.draw();this.options.onAnimationComplete.call(this)}return this},generateLegend:function(){return A(this.options.legendTemplate,this)},destroy:function(){this.clear();D(this,this.events);var t=this.chart.canvas;t.width=this.chart.width;t.height=this.chart.height;if(t.style.removeProperty){t.style.removeProperty("width");t.style.removeProperty("height")}else{t.style.removeAttribute("width");t.style.removeAttribute("height")}delete a.instances[this.id]},showTooltip:function(t,i){if(typeof this.activeElements==="undefined")this.activeElements=[];var e=function(t){var e=false;if(t.length!==this.activeElements.length){e=true;return e}S(t,function(t,i){if(t!==this.activeElements[i]){e=true}},this);return e}.call(this,t);if(!e&&!i){return}else{this.activeElements=t}this.draw();if(this.options.customTooltips){this.options.customTooltips(false)}if(t.length>0){if(this.datasets&&this.datasets.length>1){var s,r;for(var n=this.datasets.length-1;n>=0;n--){s=this.datasets[n].points||this.datasets[n].bars||this.datasets[n].segments;r=f(s,t[0]);if(r!==-1){break}}var c=[],u=[],o=function(t){var i=[],e,s=[],n=[],o,a,h,l;d.each(this.datasets,function(t){e=t.points||t.bars||t.segments;if(e[r]&&e[r].hasValue()){i.push(e[r])}});d.each(i,function(t){s.push(t.x);n.push(t.y);c.push(d.template(this.options.multiTooltipTemplate,t));u.push({fill:t._saved.fillColor||t.fillColor,stroke:t._saved.strokeColor||t.strokeColor})},this);l=y(n);a=x(n);h=y(s);o=x(s);return{x:h>this.chart.width/2?h:o,y:(l+a)/2}}.call(this,r);new a.MultiTooltip({x:o.x,y:o.y,xPadding:this.options.tooltipXPadding,yPadding:this.options.tooltipYPadding,xOffset:this.options.tooltipXOffset,fillColor:this.options.tooltipFillColor,textColor:this.options.tooltipFontColor,fontFamily:this.options.tooltipFontFamily,fontStyle:this.options.tooltipFontStyle,fontSize:this.options.tooltipFontSize,titleTextColor:this.options.tooltipTitleFontColor,titleFontFamily:this.options.tooltipTitleFontFamily,titleFontStyle:this.options.tooltipTitleFontStyle,titleFontSize:this.options.tooltipTitleFontSize,cornerRadius:this.options.tooltipCornerRadius,labels:c,legendColors:u,legendColorBackground:this.options.multiTooltipKeyBackground,title:A(this.options.tooltipTitleTemplate,t[0]),chart:this.chart,ctx:this.chart.ctx,custom:this.options.customTooltips}).draw()}else{S(t,function(t){var i=t.tooltipPosition();new a.Tooltip({x:Math.round(i.x),y:Math.round(i.y),xPadding:this.options.tooltipXPadding,yPadding:this.options.tooltipYPadding,fillColor:this.options.tooltipFillColor,textColor:this.options.tooltipFontColor,fontFamily:this.options.tooltipFontFamily,fontStyle:this.options.tooltipFontStyle,fontSize:this.options.tooltipFontSize,caretHeight:this.options.tooltipCaretSize,cornerRadius:this.options.tooltipCornerRadius,text:A(this.options.tooltipTemplate,t),chart:this.chart,custom:this.options.customTooltips}).draw()},this)}}return this},toBase64Image:function(){return this.chart.canvas.toDataURL.apply(this.chart.canvas,arguments)}});a.Type.extend=function(t){var i=this;var s=function(){return i.apply(this,arguments)};s.prototype=o(i.prototype);h(s.prototype,t);s.extend=a.Type.extend;if(t.name||i.prototype.name){var n=t.name||i.prototype.name;var e=a.defaults[i.prototype.name]?o(a.defaults[i.prototype.name]):{};a.defaults[n]=h(e,t.defaults);a.types[n]=s;a.prototype[n]=function(t,i){var e=l(a.defaults.global,a.defaults[n],i||{});return new s(t,e,this)}}else{p("Name not provided for this chart, so it hasn't been registered")}return i};a.Element=function(t){h(this,t);this.initialize.apply(this,arguments);this.save()};h(a.Element.prototype,{initialize:function(){},restore:function(t){if(!t){h(this,this._saved)}else{S(t,function(t){this[t]=this._saved[t]},this)}return this},save:function(){this._saved=o(this);delete this._saved._saved;return this},update:function(t){S(t,function(t,i){this._saved[i]=this[i];this[i]=t},this);return this},transition:function(t,e){S(t,function(t,i){this[i]=(t-this._saved[i])*e+this._saved[i]},this);return this},tooltipPosition:function(){return{x:this.x,y:this.y}},hasValue:function(){return m(this.value)}});a.Element.extend=r;a.Point=a.Element.extend({display:true,inRange:function(t,i){var e=this.hitDetectionRadius+this.radius;return Math.pow(t-this.x,2)+Math.pow(i-this.y,2)<Math.pow(e,2)},draw:function(){if(this.display){var t=this.ctx;t.beginPath();t.arc(this.x,this.y,this.radius,0,Math.PI*2);t.closePath();t.strokeStyle=this.strokeColor;t.lineWidth=this.strokeWidth;t.fillStyle=this.fillColor;t.fill();t.stroke()}}});a.Arc=a.Element.extend({inRange:function(t,i){var e=d.getAngleFromPoint(this,{x:t,y:i});var s=e.angle%(Math.PI*2),n=(Math.PI*2+this.startAngle)%(Math.PI*2),o=(Math.PI*2+this.endAngle)%(Math.PI*2)||360;var a=o<n?s<=o||s>=n:s>=n&&s<=o;var h=e.distance>=this.innerRadius&&e.distance<=this.outerRadius;return a&&h},tooltipPosition:function(){var t=this.startAngle+(this.endAngle-this.startAngle)/2,i=(this.outerRadius-this.innerRadius)/2+this.innerRadius;return{x:this.x+Math.cos(t)*i,y:this.y+Math.sin(t)*i}},draw:function(t){var i=t||1;var e=this.ctx;e.beginPath();e.arc(this.x,this.y,this.outerRadius<0?0:this.outerRadius,this.startAngle,this.endAngle);e.arc(this.x,this.y,this.innerRadius<0?0:this.innerRadius,this.endAngle,this.startAngle,true);e.closePath();e.strokeStyle=this.strokeColor;e.lineWidth=this.strokeWidth;e.fillStyle=this.fillColor;e.fill();e.lineJoin="bevel";if(this.showStroke){e.stroke()}}});a.Rectangle=a.Element.extend({draw:function(){var t=this.ctx,i=this.width/2,e=this.x-i,s=this.x+i,n=this.base-(this.base-this.y),o=this.strokeWidth/2;if(this.showStroke){e+=o;s-=o;n+=o}t.beginPath();t.fillStyle=this.fillColor;t.strokeStyle=this.strokeColor;t.lineWidth=this.strokeWidth;t.moveTo(e,this.base);t.lineTo(e,n);t.lineTo(s,n);t.lineTo(s,this.base);t.fill();if(this.showStroke){t.stroke()}},height:function(){return this.base-this.y},inRange:function(t,i){return t>=this.x-this.width/2&&t<=this.x+this.width/2&&(i>=this.y&&i<=this.base)}});a.Animation=a.Element.extend({currentStep:null,numSteps:60,easing:"",render:null,onAnimationProgress:null,onAnimationComplete:null});a.Tooltip=a.Element.extend({draw:function(){var t=this.chart.ctx;t.font=q(this.fontSize,this.fontStyle,this.fontFamily);this.xAlign="center";this.yAlign="above";var i=this.caretPadding=2;var e=t.measureText(this.text).width+2*this.xPadding,s=this.fontSize+2*this.yPadding,n=s+this.caretHeight+i;if(this.x+e/2>this.chart.width){this.xAlign="left"}else if(this.x-e/2<0){this.xAlign="right"}if(this.y-n<0){this.yAlign="below"}var o=this.x-e/2,a=this.y-n;t.fillStyle=this.fillColor;if(this.custom){this.custom(this)}else{switch(this.yAlign){case"above":t.beginPath();t.moveTo(this.x,this.y-i);t.lineTo(this.x+this.caretHeight,this.y-(i+this.caretHeight));t.lineTo(this.x-this.caretHeight,this.y-(i+this.caretHeight));t.closePath();t.fill();break;case"below":a=this.y+i+this.caretHeight;t.beginPath();t.moveTo(this.x,this.y+i);t.lineTo(this.x+this.caretHeight,this.y+i+this.caretHeight);t.lineTo(this.x-this.caretHeight,this.y+i+this.caretHeight);t.closePath();t.fill();break}switch(this.xAlign){case"left":o=this.x-e+(this.cornerRadius+this.caretHeight);break;case"right":o=this.x-(this.cornerRadius+this.caretHeight);break}_(t,o,a,e,s,this.cornerRadius);t.fill();t.fillStyle=this.textColor;t.textAlign="center";t.textBaseline="middle";t.fillText(this.text,o+e/2,a+s/2)}}});a.MultiTooltip=a.Element.extend({initialize:function(){this.font=q(this.fontSize,this.fontStyle,this.fontFamily);this.titleFont=q(this.titleFontSize,this.titleFontStyle,this.titleFontFamily);this.titleHeight=this.title?this.titleFontSize*1.5:0;this.height=this.labels.length*this.fontSize+(this.labels.length-1)*(this.fontSize/2)+this.yPadding*2+this.titleHeight;this.ctx.font=this.titleFont;var t=this.ctx.measureText(this.title).width,i=N(this.ctx,this.font,this.labels)+this.fontSize+3,e=x([i,t]);this.width=e+this.xPadding*2;var s=this.height/2;if(this.y-s<0){this.y=s}else if(this.y+s>this.chart.height){this.y=this.chart.height-s}if(this.x>this.chart.width/2){this.x-=this.xOffset+this.width}else{this.x+=this.xOffset}},getLineHeight:function(t){var i=this.y-this.height/2+this.yPadding,e=t-1;if(t===0){return i+this.titleHeight/3}else{return i+(this.fontSize*1.5*e+this.fontSize/2)+this.titleHeight}},draw:function(){if(this.custom){this.custom(this)}else{_(this.ctx,this.x,this.y-this.height/2,this.width,this.height,this.cornerRadius);var e=this.ctx;e.fillStyle=this.fillColor;e.fill();e.closePath();e.textAlign="left";e.textBaseline="middle";e.fillStyle=this.titleTextColor;e.font=this.titleFont;e.fillText(this.title,this.x+this.xPadding,this.getLineHeight(0));e.font=this.font;d.each(this.labels,function(t,i){e.fillStyle=this.textColor;e.fillText(t,this.x+this.xPadding+this.fontSize+3,this.getLineHeight(i+1));e.fillStyle=this.legendColorBackground;e.fillRect(this.x+this.xPadding,this.getLineHeight(i+1)-this.fontSize/2,this.fontSize,this.fontSize);e.fillStyle=this.legendColors[i].fill;e.fillRect(this.x+this.xPadding,this.getLineHeight(i+1)-this.fontSize/2,this.fontSize,this.fontSize)},this)}}});a.Scale=a.Element.extend({initialize:function(){this.fit()},buildYLabels:function(){this.yLabels=[];var t=C(this.stepValue);for(var i=0;i<=this.steps;i++){this.yLabels.push(A(this.templateString,{value:(this.min+i*this.stepValue).toFixed(t)}))}this.yLabelWidth=this.display&&this.showLabels?N(this.ctx,this.font,this.yLabels)+10:0},addXLabel:function(t){this.xLabels.push(t);this.valuesCount++;this.fit()},removeXLabel:function(){this.xLabels.shift();this.valuesCount--;this.fit()},fit:function(){this.startPoint=this.display?this.fontSize:0;this.endPoint=this.display?this.height-this.fontSize*1.5-5:this.height;this.startPoint+=this.padding;this.endPoint-=this.padding;var t=this.endPoint;var i=this.endPoint-this.startPoint,e;this.calculateYRange(i);this.buildYLabels();this.calculateXLabelRotation();while(i>this.endPoint-this.startPoint){i=this.endPoint-this.startPoint;e=this.yLabelWidth;this.calculateYRange(i);this.buildYLabels();if(e<this.yLabelWidth){this.endPoint=t;this.calculateXLabelRotation()}}},calculateXLabelRotation:function(){this.ctx.font=this.font;var t=this.ctx.measureText(this.xLabels[0]).width,i=this.ctx.measureText(this.xLabels[this.xLabels.length-1]).width,e,s;this.xScalePaddingRight=i/2+3;this.xScalePaddingLeft=t/2>this.yLabelWidth?t/2:this.yLabelWidth;this.xLabelRotation=0;return;if(this.display){var n=N(this.ctx,this.font,this.xLabels),o,a;this.xLabelWidth=n;var h=Math.floor(this.calculateX(1)-this.calculateX(0))-6;while(this.xLabelWidth>h&&this.xLabelRotation===0||this.xLabelWidth>h&&this.xLabelRotation<=90&&this.xLabelRotation>0){o=Math.cos(b(this.xLabelRotation));e=o*t;s=o*i;if(e+this.fontSize/2>this.yLabelWidth){this.xScalePaddingLeft=e+this.fontSize/2}this.xScalePaddingRight=this.fontSize/2;this.xLabelRotation++;this.xLabelWidth=o*n}if(this.xLabelRotation>0){this.endPoint-=Math.sin(b(this.xLabelRotation))*n+3}}else{this.xLabelWidth=0;this.xScalePaddingRight=this.padding;this.xScalePaddingLeft=this.padding}},calculateYRange:c,drawingArea:function(){return this.startPoint-this.endPoint},calculateY:function(t){var i=this.drawingArea()/(this.min-this.max);return this.endPoint-i*(t-this.min)},calculateX:function(t){var i=this.xLabelRotation>0,e=this.width-(this.xScalePaddingLeft+this.xScalePaddingRight),s=e/Math.max(this.valuesCount-(this.offsetGridLines?0:1),1),n=s*t+this.xScalePaddingLeft;if(this.offsetGridLines){n+=s/2}return Math.round(n)},update:function(t){d.extend(this,t);this.fit()},draw:function(){var a=this.ctx,o=(this.endPoint-this.startPoint)/this.steps,h=Math.round(this.xScalePaddingLeft);if(this.display){a.fillStyle=this.textColor;a.font=this.font;S(this.yLabels,function(t,i){var e=this.endPoint-o*i,s=Math.round(e),n=this.showHorizontalLines;a.textAlign="right";a.textBaseline="middle";if(this.showLabels){a.fillText(t,h-10,e)}if(i===0&&!n){n=true}if(n){a.beginPath()}if(i>0){a.lineWidth=this.gridLineWidth;a.strokeStyle=this.gridLineColor}else{a.lineWidth=this.lineWidth;a.strokeStyle=this.lineColor}s+=d.aliasPixel(a.lineWidth);if(n){a.moveTo(h,s);a.lineTo(this.width,s);a.stroke();a.closePath()}a.lineWidth=this.lineWidth;a.strokeStyle=this.lineColor;a.beginPath();a.moveTo(h-5,s);a.lineTo(h,s);a.stroke();a.closePath()},this);S(this.xLabels,function(t,i){if((i+1)%this.xLabelsSkip)return;var e=this.calculateX(i)+P(this.lineWidth),s=this.calculateX(i-(this.offsetGridLines?.5:0))+P(this.lineWidth),n=this.xLabelRotation>0,o=this.showVerticalLines;if(i===0&&!o){o=true}if(o){a.beginPath()}if(i>0){a.lineWidth=this.gridLineWidth;a.strokeStyle=this.gridLineColor}else{a.lineWidth=this.lineWidth;a.strokeStyle=this.lineColor}if(o){a.moveTo(s,this.endPoint);a.lineTo(s,this.startPoint-3);a.stroke();a.closePath()}a.lineWidth=this.lineWidth;a.strokeStyle=this.lineColor;a.beginPath();a.moveTo(s,this.endPoint);a.lineTo(s,this.endPoint+5);a.stroke();a.closePath();a.save();a.translate(e,n?this.endPoint+12:this.endPoint+8);a.rotate(b(this.xLabelRotation)*-1);a.font=this.font;a.textAlign=n?"right":"center";a.textBaseline=n?"middle":"top";a.fillText(t,0,0);a.restore()},this)}}});a.RadialScale=a.Element.extend({initialize:function(){this.size=y([this.height,this.width]);this.drawingArea=this.display?this.size/2-(this.fontSize/2+this.backdropPaddingY):this.size/2},calculateCenterOffset:function(t){var i=this.drawingArea/(this.max-this.min);return(t-this.min)*i},update:function(){if(!this.lineArc){this.setScaleSize()}else{this.drawingArea=this.display?this.size/2-(this.fontSize/2+this.backdropPaddingY):this.size/2}this.buildYLabels()},buildYLabels:function(){this.yLabels=[];var t=C(this.stepValue);for(var i=0;i<=this.steps;i++){this.yLabels.push(A(this.templateString,{value:(this.min+i*this.stepValue).toFixed(t)}))}},getCircumference:function(){return Math.PI*2/this.valuesCount},setScaleSize:function(){var t=y([this.height/2-this.pointLabelFontSize-5,this.width/2]),i,e,s,n,o=this.width,a,h,l=0,r,c,u,d,f,p,g;this.ctx.font=q(this.pointLabelFontSize,this.pointLabelFontStyle,this.pointLabelFontFamily);for(e=0;e<this.valuesCount;e++){i=this.getPointPosition(e,t);s=this.ctx.measureText(A(this.templateString,{value:this.labels[e]})).width+5;if(e===0||e===this.valuesCount/2){n=s/2;if(i.x+n>o){o=i.x+n;a=e}if(i.x-n<l){l=i.x-n;r=e}}else if(e<this.valuesCount/2){if(i.x+s>o){o=i.x+s;a=e}}else if(e>this.valuesCount/2){if(i.x-s<l){l=i.x-s;r=e}}}u=l;d=Math.ceil(o-this.width);h=this.getIndexAngle(a);c=this.getIndexAngle(r);f=d/Math.sin(h+Math.PI/2);p=u/Math.sin(c+Math.PI/2);f=m(f)?f:0;p=m(p)?p:0;this.drawingArea=t-(p+f)/2;this.setCenterPoint(p,f)},setCenterPoint:function(t,i){var e=this.width-i-this.drawingArea,s=t+this.drawingArea;this.xCenter=(s+e)/2;this.yCenter=this.height/2},getIndexAngle:function(t){var i=Math.PI*2/this.valuesCount;return t*i-Math.PI/2},getPointPosition:function(t,i){var e=this.getIndexAngle(t);return{x:Math.cos(e)*i+this.xCenter,y:Math.sin(e)*i+this.yCenter}},draw:function(){if(this.display){var h=this.ctx;S(this.yLabels,function(t,i){if(i>0){var e=i*(this.drawingArea/this.steps),s=this.yCenter-e,n;if(this.lineWidth>0){h.strokeStyle=this.lineColor;h.lineWidth=this.lineWidth;if(this.lineArc){h.beginPath();h.arc(this.xCenter,this.yCenter,e,0,Math.PI*2);h.closePath();h.stroke()}else{h.beginPath();for(var o=0;o<this.valuesCount;o++){n=this.getPointPosition(o,this.calculateCenterOffset(this.min+i*this.stepValue));if(o===0){h.moveTo(n.x,n.y)}else{h.lineTo(n.x,n.y)}}h.closePath();h.stroke()}}if(this.showLabels){h.font=q(this.fontSize,this.fontStyle,this.fontFamily);if(this.showLabelBackdrop){var a=h.measureText(t).width;h.fillStyle=this.backdropColor;h.fillRect(this.xCenter-a/2-this.backdropPaddingX,s-this.fontSize/2-this.backdropPaddingY,a+this.backdropPaddingX*2,this.fontSize+this.backdropPaddingY*2)}h.textAlign="center";h.textBaseline="middle";h.fillStyle=this.fontColor;h.fillText(t,this.xCenter,s)}}},this);if(!this.lineArc){h.lineWidth=this.angleLineWidth;h.strokeStyle=this.angleLineColor;for(var t=this.valuesCount-1;t>=0;t--){var i=null,e=null;if(this.angleLineWidth>0){i=this.calculateCenterOffset(this.max);e=this.getPointPosition(t,i);h.beginPath();h.moveTo(this.xCenter,this.yCenter);h.lineTo(e.x,e.y);h.stroke();h.closePath()}if(this.backgroundColors&&this.backgroundColors.length==this.valuesCount){if(i==null)i=this.calculateCenterOffset(this.max);if(e==null)e=this.getPointPosition(t,i);var s=this.getPointPosition(t===0?this.valuesCount-1:t-1,i);var n=this.getPointPosition(t===this.valuesCount-1?0:t+1,i);var o={x:(s.x+e.x)/2,y:(s.y+e.y)/2};var a={x:(e.x+n.x)/2,y:(e.y+n.y)/2};h.beginPath();h.moveTo(this.xCenter,this.yCenter);h.lineTo(o.x,o.y);h.lineTo(e.x,e.y);h.lineTo(a.x,a.y);h.fillStyle=this.backgroundColors[t];h.fill();h.closePath()}var l=this.getPointPosition(t,this.calculateCenterOffset(this.max)+5);h.font=q(this.pointLabelFontSize,this.pointLabelFontStyle,this.pointLabelFontFamily);h.fillStyle=this.pointLabelFontColor;var r=this.labels.length,c=this.labels.length/2,u=c/2,d=t<u||t>r-u,f=t===u||t===r-u;if(t===0){h.textAlign="center"}else if(t===c){h.textAlign="center"}else if(t<c){h.textAlign="left"}else{h.textAlign="right"}if(f){h.textBaseline="middle"}else if(d){h.textBaseline="bottom"}else{h.textBaseline="top"}h.fillText(this.labels[t],l.x,l.y)}}}}});a.animationService={frameDuration:17,animations:[],dropFrames:0,addAnimation:function(t,i){for(var e=0;e<this.animations.length;++e){if(this.animations[e].chartInstance===t){this.animations[e].animationObject=i;return}}this.animations.push({chartInstance:t,animationObject:i});if(this.animations.length==1){d.requestAnimFrame.call(window,this.digestWrapper)}},cancelAnimation:function(i){var t=d.findNextWhere(this.animations,function(t){return t.chartInstance===i});if(t){this.animations.splice(t,1)}},digestWrapper:function(){a.animationService.startDigest.call(a.animationService)},startDigest:function(){var t=Date.now();var i=0;if(this.dropFrames>1){i=Math.floor(this.dropFrames);this.dropFrames-=i}for(var e=0;e<this.animations.length;e++){if(this.animations[e].animationObject.currentStep===null){this.animations[e].animationObject.currentStep=0}this.animations[e].animationObject.currentStep+=1+i;if(this.animations[e].animationObject.currentStep>this.animations[e].animationObject.numSteps){this.animations[e].animationObject.currentStep=this.animations[e].animationObject.numSteps}this.animations[e].animationObject.render(this.animations[e].chartInstance,this.animations[e].animationObject);if(this.animations[e].animationObject.currentStep==this.animations[e].animationObject.numSteps){this.animations[e].animationObject.onAnimationComplete.call(this.animations[e].chartInstance);this.animations.splice(e,1);e--}}var s=Date.now();var n=s-t-this.frameDuration;var o=n/this.frameDuration;if(o>1){this.dropFrames+=o}if(this.animations.length>0){d.requestAnimFrame.call(window,this.digestWrapper)}}};d.addEvent(window,"resize",function(){var t;return function(){clearTimeout(t);t=setTimeout(function(){S(a.instances,function(t){if(t.options.responsive){t.resize(t.render,true)}})},50)}}());if(g){define("Chart",[],function(){return a})}else if(typeof module==="object"&&module.exports){module.exports=a}t.Chart=a;a.noConflict=function(){t.Chart=i;return a}}).call(this);(function(){"use strict";var t=this,i=t.Chart,h=i.helpers;var e={scaleBeginAtZero:true,scaleShowGridLines:true,scaleGridLineColor:"rgba(0,0,0,.05)",scaleGridLineWidth:1,scaleShowHorizontalLines:true,scaleShowVerticalLines:true,barShowStroke:true,barStrokeWidth:2,barValueSpacing:5,barDatasetSpacing:1,legendTemplate:'<ul class="<%=name.toLowerCase()%>-legend"><% for (var i=0; i<datasets.length; i++){%><li><span style="background-color:<%=datasets[i].fillColor%>"><%if(datasets[i].label){%><%=datasets[i].label%><%}%></span></li><%}%></ul>'};i.Type.extend({name:"Bar",defaults:e,initialize:function(n){var a=this.options;this.ScaleClass=i.Scale.extend({offsetGridLines:true,calculateBarX:function(t,i,e){var s=this.calculateBaseWidth(),n=this.calculateX(e)-s/2,o=this.calculateBarWidth(t);return n+o*i+i*a.barDatasetSpacing+o/2},calculateBaseWidth:function(){return this.calculateX(1)-this.calculateX(0)-2*a.barValueSpacing},calculateBarWidth:function(t){var i=this.calculateBaseWidth()-(t-1)*a.barDatasetSpacing;return i/t}});this.datasets=[];if(this.options.showTooltips){h.bindEvents(this,this.options.tooltipEvents,function(t){var i=t.type!=="mouseout"?this.getBarsAtEvent(t):[];this.eachBars(function(t){t.restore(["fillColor","strokeColor"])});h.each(i,function(t){t.fillColor=t.highlightFill;t.strokeColor=t.highlightStroke});this.showTooltip(i)})}this.BarClass=i.Rectangle.extend({strokeWidth:this.options.barStrokeWidth,showStroke:this.options.barShowStroke,ctx:this.chart.ctx});h.each(n.datasets,function(e,t){var s={label:e.label||null,fillColor:e.fillColor,strokeColor:e.strokeColor,bars:[]};this.datasets.push(s);h.each(e.data,function(t,i){s.bars.push(new this.BarClass({value:t,label:n.labels[i],datasetLabel:e.label,strokeColor:e.strokeColor,fillColor:e.fillColor,highlightFill:e.highlightFill||e.fillColor,highlightStroke:e.highlightStroke||e.strokeColor}))},this)},this);this.buildScale(n.labels);this.BarClass.prototype.base=this.scale.endPoint;this.eachBars(function(t,i,e){h.extend(t,{width:this.scale.calculateBarWidth(this.datasets.length),x:this.scale.calculateBarX(this.datasets.length,e,i),y:this.scale.endPoint});t.save()},this);this.render()},update:function(){this.scale.update();h.each(this.activeElements,function(t){t.restore(["fillColor","strokeColor"])});this.eachBars(function(t){t.save()});this.render()},eachBars:function(e){h.each(this.datasets,function(t,i){h.each(t.bars,e,this,i)},this)},getBarsAtEvent:function(t){var i=[],e=h.getRelativePosition(t),s=function(t){i.push(t.bars[n])},n;for(var o=0;o<this.datasets.length;o++){for(n=0;n<this.datasets[o].bars.length;n++){if(this.datasets[o].bars[n].inRange(e.x,e.y)){h.each(this.datasets,s);return i}}}return i},buildScale:function(t){var e=this;var s=function(){var i=[];e.eachBars(function(t){i.push(t.value)});return i};var i={templateString:this.options.scaleLabel,height:this.chart.height,width:this.chart.width,ctx:this.chart.ctx,textColor:this.options.scaleFontColor,fontSize:this.options.scaleFontSize,fontStyle:this.options.scaleFontStyle,fontFamily:this.options.scaleFontFamily,valuesCount:t.length,beginAtZero:this.options.scaleBeginAtZero,integersOnly:this.options.scaleIntegersOnly,calculateYRange:function(t){var i=h.calculateScaleRange(s(),t,this.fontSize,this.beginAtZero,this.integersOnly);h.extend(this,i)},xLabels:t,font:h.fontString(this.options.scaleFontSize,this.options.scaleFontStyle,this.options.scaleFontFamily),lineWidth:this.options.scaleLineWidth,lineColor:this.options.scaleLineColor,showHorizontalLines:this.options.scaleShowHorizontalLines,showVerticalLines:this.options.scaleShowVerticalLines,gridLineWidth:this.options.scaleShowGridLines?this.options.scaleGridLineWidth:0,gridLineColor:this.options.scaleShowGridLines?this.options.scaleGridLineColor:"rgba(0,0,0,0)",padding:this.options.showScale?0:this.options.barShowStroke?this.options.barStrokeWidth:0,showLabels:this.options.scaleShowLabels,display:this.options.showScale};if(this.options.scaleOverride){h.extend(i,{calculateYRange:h.noop,steps:this.options.scaleSteps,stepValue:this.options.scaleStepWidth,min:this.options.scaleStartValue,max:this.options.scaleStartValue+this.options.scaleSteps*this.options.scaleStepWidth})}this.scale=new this.ScaleClass(i)},addData:function(t,e){h.each(t,function(t,i){this.datasets[i].bars.push(new this.BarClass({value:t,label:e,datasetLabel:this.datasets[i].label,x:this.scale.calculateBarX(this.datasets.length,i,this.scale.valuesCount+1),y:this.scale.endPoint,width:this.scale.calculateBarWidth(this.datasets.length),base:this.scale.endPoint,strokeColor:this.datasets[i].strokeColor,fillColor:this.datasets[i].fillColor}))},this);this.scale.addXLabel(e);this.update()},removeData:function(){this.scale.removeXLabel();h.each(this.datasets,function(t){t.bars.shift()},this);this.update()},reflow:function(){h.extend(this.BarClass.prototype,{y:this.scale.endPoint,base:this.scale.endPoint});var t=h.extend({height:this.chart.height,width:this.chart.width});this.scale.update(t)},draw:function(t){var s=t||1;this.clear();var i=this.chart.ctx;this.scale.draw(s);h.each(this.datasets,function(t,e){h.each(t.bars,function(t,i){if(t.hasValue()){t.base=this.scale.endPoint;t.transition({x:this.scale.calculateBarX(this.datasets.length,e,i),y:this.scale.calculateY(t.value),width:this.scale.calculateBarWidth(this.datasets.length)},s).draw()}},this)},this)}})}).call(this);(function(){"use strict";var t=this,n=t.Chart,s=n.helpers;var i={segmentShowStroke:true,segmentStrokeColor:"#fff",segmentStrokeWidth:2,percentageInnerCutout:50,animationSteps:100,animationEasing:"easeOutBounce",animateRotate:true,animateScale:false,legendTemplate:'<ul class="<%=name.toLowerCase()%>-legend"><% for (var i=0; i<segments.length; i++){%><li><span style="background-color:<%=segments[i].fillColor%>"><%if(segments[i].label){%><%=segments[i].label%><%}%></span></li><%}%></ul>'};n.Type.extend({name:"Doughnut",defaults:i,initialize:function(e){this.segments=[];this.outerRadius=(s.min([this.chart.width,this.chart.height])-this.options.segmentStrokeWidth/2)/2;this.SegmentArc=n.Arc.extend({ctx:this.chart.ctx,x:this.chart.width/2,y:this.chart.height/2});if(this.options.showTooltips){s.bindEvents(this,this.options.tooltipEvents,function(t){var i=t.type!=="mouseout"?this.getSegmentsAtEvent(t):[];s.each(this.segments,function(t){t.restore(["fillColor"])});s.each(i,function(t){t.fillColor=t.highlightColor});this.showTooltip(i)})}this.calculateTotal(e);s.each(e,function(t,i){if(!t.color){t.color="hsl("+360*i/e.length+", 100%, 50%)"}this.addData(t,i,true)},this);this.render()},getSegmentsAtEvent:function(t){var i=[];var e=s.getRelativePosition(t);s.each(this.segments,function(t){if(t.inRange(e.x,e.y))i.push(t)},this);return i},addData:function(t,i,e){var s=i!==undefined?i:this.segments.length;if(typeof t.color==="undefined"){t.color=n.defaults.global.segmentColorDefault[s%n.defaults.global.segmentColorDefault.length];t.highlight=n.defaults.global.segmentHighlightColorDefaults[s%n.defaults.global.segmentHighlightColorDefaults.length]}this.segments.splice(s,0,new this.SegmentArc({value:t.value,outerRadius:this.options.animateScale?0:this.outerRadius,innerRadius:this.options.animateScale?0:this.outerRadius/100*this.options.percentageInnerCutout,fillColor:t.color,highlightColor:t.highlight||t.color,showStroke:this.options.segmentShowStroke,strokeWidth:this.options.segmentStrokeWidth,strokeColor:this.options.segmentStrokeColor,startAngle:Math.PI*1.5,circumference:this.options.animateRotate?0:this.calculateCircumference(t.value),label:t.label}));if(!e){this.reflow();this.update()}},calculateCircumference:function(t){if(this.total>0){return Math.PI*2*(t/this.total)}else{return 0}},calculateTotal:function(t){this.total=0;s.each(t,function(t){this.total+=Math.abs(t.value)},this)},update:function(){this.calculateTotal(this.segments);s.each(this.activeElements,function(t){t.restore(["fillColor"])});s.each(this.segments,function(t){t.save()});this.render()},removeData:function(t){var i=s.isNumber(t)?t:this.segments.length-1;this.segments.splice(i,1);this.reflow();this.update()},reflow:function(){s.extend(this.SegmentArc.prototype,{x:this.chart.width/2,y:this.chart.height/2});this.outerRadius=(s.min([this.chart.width,this.chart.height])-this.options.segmentStrokeWidth/2)/2;s.each(this.segments,function(t){t.update({outerRadius:this.outerRadius,innerRadius:this.outerRadius/100*this.options.percentageInnerCutout})},this)},draw:function(t){var e=t?t:1;this.clear();s.each(this.segments,function(t,i){t.transition({circumference:this.calculateCircumference(t.value),outerRadius:this.outerRadius,innerRadius:this.outerRadius/100*this.options.percentageInnerCutout},e);t.endAngle=t.startAngle+t.circumference;t.draw();if(i===0){t.startAngle=Math.PI*1.5}if(i<this.segments.length-1){this.segments[i+1].startAngle=t.endAngle}},this)}});n.types.Doughnut.extend({name:"Pie",defaults:s.merge(i,{percentageInnerCutout:0})})}).call(this);(function(){"use strict";var t=this,o=t.Chart,l=o.helpers;var i={scaleShowGridLines:true,scaleGridLineColor:"rgba(0,0,0,.05)",scaleGridLineWidth:1,scaleShowHorizontalLines:true,scaleShowVerticalLines:true,bezierCurve:true,bezierCurveTension:.4,pointDot:true,pointDotRadius:4,pointDotStrokeWidth:1,pointHitDetectionRadius:20,datasetStroke:true,datasetStrokeWidth:2,datasetFill:true,legendTemplate:'<ul class="<%=name.toLowerCase()%>-legend"><% for (var i=0; i<datasets.length; i++){%><li><span style="background-color:<%=datasets[i].strokeColor%>"><%if(datasets[i].label){%><%=datasets[i].label%><%}%></span></li><%}%></ul>',offsetGridLines:false};o.Type.extend({name:"Line",defaults:i,initialize:function(n){this.PointClass=o.Point.extend({offsetGridLines:this.options.offsetGridLines,strokeWidth:this.options.pointDotStrokeWidth,radius:this.options.pointDotRadius,display:this.options.pointDot,hitDetectionRadius:this.options.pointHitDetectionRadius,ctx:this.chart.ctx,inRange:function(t){return Math.pow(t-this.x,2)<Math.pow(this.radius+this.hitDetectionRadius,2)}});this.datasets=[];if(this.options.showTooltips){l.bindEvents(this,this.options.tooltipEvents,function(t){var i=t.type!=="mouseout"?this.getPointsAtEvent(t):[];this.eachPoints(function(t){t.restore(["fillColor","strokeColor"])});l.each(i,function(t){t.fillColor=t.highlightFill;t.strokeColor=t.highlightStroke});this.showTooltip(i)})}l.each(n.datasets,function(e){var s={label:e.label||null,fillColor:e.fillColor,strokeColor:e.strokeColor,pointColor:e.pointColor,pointStrokeColor:e.pointStrokeColor,points:[]};this.datasets.push(s);l.each(e.data,function(t,i){s.points.push(new this.PointClass({value:t,label:n.labels[i],datasetLabel:e.label,strokeColor:e.pointStrokeColor,fillColor:e.pointColor,highlightFill:e.pointHighlightFill||e.pointColor,highlightStroke:e.pointHighlightStroke||e.pointStrokeColor}))},this);this.buildScale(n.labels);this.eachPoints(function(t,i){l.extend(t,{x:this.scale.calculateX(i),y:this.scale.endPoint});t.save()},this)},this);this.render()},update:function(){this.scale.update();l.each(this.activeElements,function(t){t.restore(["fillColor","strokeColor"])});this.eachPoints(function(t){t.save()});this.render()},eachPoints:function(i){l.each(this.datasets,function(t){l.each(t.points,i,this)},this)},getPointsAtEvent:function(t){var i=[],e=l.getRelativePosition(t);l.each(this.datasets,function(t){l.each(t.points,function(t){if(t.inRange(e.x,e.y))i.push(t)})},this);return i},buildScale:function(t){var e=this;var s=function(){var i=[];e.eachPoints(function(t){i.push(t.value)});return i};var i={templateString:this.options.scaleLabel,height:this.chart.height,width:this.chart.width,ctx:this.chart.ctx,textColor:this.options.scaleFontColor,offsetGridLines:this.options.offsetGridLines,fontSize:this.options.scaleFontSize,fontStyle:this.options.scaleFontStyle,fontFamily:this.options.scaleFontFamily,valuesCount:t.length,beginAtZero:this.options.scaleBeginAtZero,integersOnly:this.options.scaleIntegersOnly,calculateYRange:function(t){var i=l.calculateScaleRange(s(),t,this.fontSize,this.beginAtZero,this.integersOnly);l.extend(this,i)},xLabels:t,xLabelsSkip:this.options.xLabelsSkip,font:l.fontString(this.options.scaleFontSize,this.options.scaleFontStyle,this.options.scaleFontFamily),lineWidth:this.options.scaleLineWidth,lineColor:this.options.scaleLineColor,showHorizontalLines:this.options.scaleShowHorizontalLines,showVerticalLines:this.options.scaleShowVerticalLines,gridLineWidth:this.options.scaleShowGridLines?this.options.scaleGridLineWidth:0,gridLineColor:this.options.scaleShowGridLines?this.options.scaleGridLineColor:"rgba(0,0,0,0)",padding:this.options.showScale?0:this.options.pointDotRadius+this.options.pointDotStrokeWidth,showLabels:this.options.scaleShowLabels,display:this.options.showScale};if(this.options.scaleOverride){l.extend(i,{calculateYRange:l.noop,steps:this.options.scaleSteps,stepValue:this.options.scaleStepWidth,min:this.options.scaleStartValue,max:this.options.scaleStartValue+this.options.scaleSteps*this.options.scaleStepWidth})}this.scale=new o.Scale(i)},addData:function(t,e){l.each(t,function(t,i){this.datasets[i].points.push(new this.PointClass({value:t,label:e,datasetLabel:this.datasets[i].label,x:this.scale.calculateX(this.scale.valuesCount+1),y:this.scale.endPoint,strokeColor:this.datasets[i].pointStrokeColor,fillColor:this.datasets[i].pointColor}))},this);this.scale.addXLabel(e);this.update()},removeData:function(){this.scale.removeXLabel();l.each(this.datasets,function(t){t.points.shift()},this);this.update()},reflow:function(){var t=l.extend({height:this.chart.height,width:this.chart.width});this.scale.update(t)},draw:function(t){var e=t||1;this.clear();var n=this.chart.ctx;var o=function(t){return t.value!==null},a=function(t,i,e){return l.findNextWhere(i,o,e)||t},h=function(t,i,e){return l.findPreviousWhere(i,o,e)||t};if(!this.scale)return;this.scale.draw(e);l.each(this.datasets,function(t){var s=l.where(t.points,o);l.each(t.points,function(t,i){if(t.hasValue()){t.transition({y:this.scale.calculateY(t.value),x:this.scale.calculateX(i)},e)}},this);if(this.options.bezierCurve){l.each(s,function(t,i){var e=i>0&&i<s.length-1?this.options.bezierCurveTension:0;t.controlPoints=l.splineCurve(h(t,s,i),t,a(t,s,i),e);if(t.controlPoints.outer.y>this.scale.endPoint){t.controlPoints.outer.y=this.scale.endPoint}else if(t.controlPoints.outer.y<this.scale.startPoint){t.controlPoints.outer.y=this.scale.startPoint}if(t.controlPoints.inner.y>this.scale.endPoint){t.controlPoints.inner.y=this.scale.endPoint}else if(t.controlPoints.inner.y<this.scale.startPoint){t.controlPoints.inner.y=this.scale.startPoint}},this)}n.lineWidth=this.options.datasetStrokeWidth;n.strokeStyle=t.strokeColor;n.beginPath();l.each(s,function(t,i){if(i===0){n.moveTo(t.x,t.y)}else{if(this.options.bezierCurve){var e=h(t,s,i);n.bezierCurveTo(e.controlPoints.outer.x,e.controlPoints.outer.y,t.controlPoints.inner.x,t.controlPoints.inner.y,t.x,t.y)}else{n.lineTo(t.x,t.y)}}},this);if(this.options.datasetStroke){n.stroke()}if(this.options.datasetFill&&s.length>0){n.lineTo(s[s.length-1].x,this.scale.endPoint);n.lineTo(s[0].x,this.scale.endPoint);n.fillStyle=t.fillColor;n.closePath();n.fill()}l.each(s,function(t){t.draw()})},this)}})}).call(this);(function(){"use strict";var t=this,i=t.Chart,s=i.helpers;var e={scaleShowLabelBackdrop:true,scaleBackdropColor:"rgba(255,255,255,0.75)",scaleBeginAtZero:true,scaleBackdropPaddingY:2,scaleBackdropPaddingX:2,scaleShowLine:true,segmentShowStroke:true,segmentStrokeColor:"#fff",segmentStrokeWidth:2,animationSteps:100,animationEasing:"easeOutBounce",animateRotate:true,animateScale:false,legendTemplate:'<ul class="<%=name.toLowerCase()%>-legend"><% for (var i=0; i<segments.length; i++){%><li><span style="background-color:<%=segments[i].fillColor%>"><%if(segments[i].label){%><%=segments[i].label%><%}%></span></li><%}%></ul>'};i.Type.extend({name:"PolarArea",defaults:e,initialize:function(t){this.segments=[];this.SegmentArc=i.Arc.extend({showStroke:this.options.segmentShowStroke,strokeWidth:this.options.segmentStrokeWidth,strokeColor:this.options.segmentStrokeColor,ctx:this.chart.ctx,innerRadius:0,x:this.chart.width/2,y:this.chart.height/2});this.scale=new i.RadialScale({display:this.options.showScale,fontStyle:this.options.scaleFontStyle,fontSize:this.options.scaleFontSize,fontFamily:this.options.scaleFontFamily,fontColor:this.options.scaleFontColor,showLabels:this.options.scaleShowLabels,showLabelBackdrop:this.options.scaleShowLabelBackdrop,backdropColor:this.options.scaleBackdropColor,backdropPaddingY:this.options.scaleBackdropPaddingY,backdropPaddingX:this.options.scaleBackdropPaddingX,lineWidth:this.options.scaleShowLine?this.options.scaleLineWidth:0,lineColor:this.options.scaleLineColor,lineArc:true,width:this.chart.width,height:this.chart.height,xCenter:this.chart.width/2,yCenter:this.chart.height/2,ctx:this.chart.ctx,templateString:this.options.scaleLabel,valuesCount:t.length});this.updateScaleRange(t);this.scale.update();s.each(t,function(t,i){this.addData(t,i,true)},this);if(this.options.showTooltips){s.bindEvents(this,this.options.tooltipEvents,function(t){var i=t.type!=="mouseout"?this.getSegmentsAtEvent(t):[];s.each(this.segments,function(t){t.restore(["fillColor"])});s.each(i,function(t){t.fillColor=t.highlightColor});this.showTooltip(i)})}this.render()},getSegmentsAtEvent:function(t){var i=[];var e=s.getRelativePosition(t);s.each(this.segments,function(t){if(t.inRange(e.x,e.y))i.push(t)},this);return i},addData:function(t,i,e){var s=i||this.segments.length;this.segments.splice(s,0,new this.SegmentArc({fillColor:t.color,highlightColor:t.highlight||t.color,label:t.label,value:t.value,outerRadius:this.options.animateScale?0:this.scale.calculateCenterOffset(t.value),circumference:this.options.animateRotate?0:this.scale.getCircumference(),startAngle:Math.PI*1.5}));if(!e){this.reflow();this.update()}},removeData:function(t){var i=s.isNumber(t)?t:this.segments.length-1;this.segments.splice(i,1);this.reflow();this.update()},calculateTotal:function(t){this.total=0;s.each(t,function(t){this.total+=t.value},this);this.scale.valuesCount=this.segments.length},updateScaleRange:function(t){var i=[];s.each(t,function(t){i.push(t.value)});var e=this.options.scaleOverride?{steps:this.options.scaleSteps,stepValue:this.options.scaleStepWidth,min:this.options.scaleStartValue,max:this.options.scaleStartValue+this.options.scaleSteps*this.options.scaleStepWidth}:s.calculateScaleRange(i,s.min([this.chart.width,this.chart.height])/2,this.options.scaleFontSize,this.options.scaleBeginAtZero,this.options.scaleIntegersOnly);s.extend(this.scale,e,{size:s.min([this.chart.width,this.chart.height]),xCenter:this.chart.width/2,yCenter:this.chart.height/2})},update:function(){this.calculateTotal(this.segments);s.each(this.segments,function(t){t.save()});this.reflow();this.render()},reflow:function(){s.extend(this.SegmentArc.prototype,{x:this.chart.width/2,y:this.chart.height/2});this.updateScaleRange(this.segments);this.scale.update();s.extend(this.scale,{xCenter:this.chart.width/2,yCenter:this.chart.height/2});s.each(this.segments,function(t){t.update({outerRadius:this.scale.calculateCenterOffset(t.value)})},this)},draw:function(t){var e=t||1;this.clear();s.each(this.segments,function(t,i){t.transition({circumference:this.scale.getCircumference(),outerRadius:this.scale.calculateCenterOffset(t.value)},e);t.endAngle=t.startAngle+t.circumference;if(i===0){t.startAngle=Math.PI*1.5}if(i<this.segments.length-1){this.segments[i+1].startAngle=t.endAngle}t.draw()},this);this.scale.draw()}})}).call(this);(function(){"use strict";var t=this,i=t.Chart,a=i.helpers;i.Type.extend({name:"Radar",defaults:{scaleShowLine:true,angleShowLineOut:true,scaleShowLabels:false,scaleBeginAtZero:true,angleLineColor:"rgba(0,0,0,.1)",angleLineWidth:1,pointLabelFontFamily:"'Arial'",pointLabelFontStyle:"normal",pointLabelFontSize:10,pointLabelFontColor:"#666",pointDot:true,pointDotRadius:3,pointDotStrokeWidth:1,pointHitDetectionRadius:20,datasetStroke:true,datasetStrokeWidth:2,datasetFill:true,legendTemplate:'<ul class="<%=name.toLowerCase()%>-legend"><% for (var i=0; i<datasets.length; i++){%><li><span style="background-color:<%=datasets[i].strokeColor%>"><%if(datasets[i].label){%><%=datasets[i].label%><%}%></span></li><%}%></ul>'},initialize:function(o){this.PointClass=i.Point.extend({strokeWidth:this.options.pointDotStrokeWidth,radius:this.options.pointDotRadius,display:this.options.pointDot,hitDetectionRadius:this.options.pointHitDetectionRadius,ctx:this.chart.ctx});this.datasets=[];this.buildScale(o);if(this.options.showTooltips){a.bindEvents(this,this.options.tooltipEvents,function(t){var i=t.type!=="mouseout"?this.getPointsAtEvent(t):[];this.eachPoints(function(t){t.restore(["fillColor","strokeColor"])});a.each(i,function(t){t.fillColor=t.highlightFill;t.strokeColor=t.highlightStroke});this.showTooltip(i)})}a.each(o.datasets,function(s){var n={label:s.label||null,fillColor:s.fillColor,strokeColor:s.strokeColor,pointColor:s.pointColor,pointStrokeColor:s.pointStrokeColor,points:[]};this.datasets.push(n);a.each(s.data,function(t,i){var e;if(!this.scale.animation){e=this.scale.getPointPosition(i,this.scale.calculateCenterOffset(t))}n.points.push(new this.PointClass({value:t,label:o.labels[i],datasetLabel:s.label,x:this.options.animation?this.scale.xCenter:e.x,y:this.options.animation?this.scale.yCenter:e.y,strokeColor:s.pointStrokeColor,fillColor:s.pointColor,highlightFill:s.pointHighlightFill||s.pointColor,highlightStroke:s.pointHighlightStroke||s.pointStrokeColor}))},this)},this);this.render()},eachPoints:function(i){a.each(this.datasets,function(t){a.each(t.points,i,this)},this)},getPointsAtEvent:function(t){var i=a.getRelativePosition(t),e=a.getAngleFromPoint({x:this.scale.xCenter,y:this.scale.yCenter},i);var s=Math.PI*2/this.scale.valuesCount,n=Math.round((e.angle-Math.PI*1.5)/s),o=[];if(n>=this.scale.valuesCount||n<0){n=0}if(e.distance<=this.scale.drawingArea){a.each(this.datasets,function(t){o.push(t.points[n])})}return o},buildScale:function(t){this.scale=new i.RadialScale({display:this.options.showScale,fontStyle:this.options.scaleFontStyle,fontSize:this.options.scaleFontSize,fontFamily:this.options.scaleFontFamily,fontColor:this.options.scaleFontColor,showLabels:this.options.scaleShowLabels,showLabelBackdrop:this.options.scaleShowLabelBackdrop,backdropColor:this.options.scaleBackdropColor,backgroundColors:this.options.scaleBackgroundColors,backdropPaddingY:this.options.scaleBackdropPaddingY,backdropPaddingX:this.options.scaleBackdropPaddingX,lineWidth:this.options.scaleShowLine?this.options.scaleLineWidth:0,lineColor:this.options.scaleLineColor,angleLineColor:this.options.angleLineColor,angleLineWidth:this.options.angleShowLineOut?this.options.angleLineWidth:0,pointLabelFontColor:this.options.pointLabelFontColor,pointLabelFontSize:this.options.pointLabelFontSize,pointLabelFontFamily:this.options.pointLabelFontFamily,pointLabelFontStyle:this.options.pointLabelFontStyle,height:this.chart.height,width:this.chart.width,xCenter:this.chart.width/2,yCenter:this.chart.height/2,ctx:this.chart.ctx,templateString:this.options.scaleLabel,labels:t.labels,valuesCount:t.datasets[0].data.length});this.scale.setScaleSize();this.updateScaleRange(t.datasets);this.scale.buildYLabels()},updateScaleRange:function(t){var i=function(){var i=[];a.each(t,function(t){if(t.data){i=i.concat(t.data)}else{a.each(t.points,function(t){i.push(t.value)})}});return i}();var e=this.options.scaleOverride?{steps:this.options.scaleSteps,stepValue:this.options.scaleStepWidth,min:this.options.scaleStartValue,max:this.options.scaleStartValue+this.options.scaleSteps*this.options.scaleStepWidth}:a.calculateScaleRange(i,a.min([this.chart.width,this.chart.height])/2,this.options.scaleFontSize,this.options.scaleBeginAtZero,this.options.scaleIntegersOnly);a.extend(this.scale,e)},addData:function(t,s){this.scale.valuesCount++;a.each(t,function(t,i){var e=this.scale.getPointPosition(this.scale.valuesCount,this.scale.calculateCenterOffset(t));this.datasets[i].points.push(new this.PointClass({value:t,label:s,datasetLabel:this.datasets[i].label,x:e.x,y:e.y,strokeColor:this.datasets[i].pointStrokeColor,fillColor:this.datasets[i].pointColor}))},this);this.scale.labels.push(s);this.reflow();this.update()},removeData:function(){this.scale.valuesCount--;this.scale.labels.shift();a.each(this.datasets,function(t){t.points.shift()},this);this.reflow();this.update()},update:function(){this.eachPoints(function(t){t.save()});this.reflow();this.render()},reflow:function(){a.extend(this.scale,{width:this.chart.width,height:this.chart.height,size:a.min([this.chart.width,this.chart.height]),xCenter:this.chart.width/2,yCenter:this.chart.height/2});this.updateScaleRange(this.datasets);this.scale.setScaleSize();this.scale.buildYLabels()},draw:function(t){var e=t||1,s=this.chart.ctx;this.clear();this.scale.draw();a.each(this.datasets,function(t){a.each(t.points,function(t,i){if(t.hasValue()){t.transition(this.scale.getPointPosition(i,this.scale.calculateCenterOffset(t.value)),e)}},this);s.lineWidth=this.options.datasetStrokeWidth;s.strokeStyle=t.strokeColor;s.beginPath();a.each(t.points,function(t,i){if(i===0){s.moveTo(t.x,t.y)}else{s.lineTo(t.x,t.y)}},this);s.closePath();s.stroke();s.fillStyle=t.fillColor;if(this.options.datasetFill){s.fill()}a.each(t.points,function(t){if(t.hasValue()){t.draw()}})},this)}})}).call(this);			
		</script>
		<script type="text/javascript">
var thisTitle="2D Flow Field";window.addEventListener("load",main,false);var HybridScheme=0;var FirstOrderUpwindScheme=1;var PowerLawScheme=2;var ExponentialScheme=3;var CenteredDifferenceScheme=4;var CXC=2.25;var U=0,V=1,P=2,Upseudo=3,Vpseudo=4,varCnt=5;var alphaP=.4,alphaU=.1,alphaV=.7;function FluidMaterial(i,t){this.viscosity=i||1;this.rho=t||1}var Node2D=function(i,t){this.x=i;this.y=t;this.west=null;this.east=null;this.north=null;this.south=null;this.aE=0;this.aW=0;this.aN=0;this.aS=0;this.aP=0;this.aP0=0;this.PCdiff=0;this.PCdiff_e=0;this.PCdiff_w=0;this.PCdiff_n=0;this.PCdiff_s=0;this.b=new Array(varCnt);this.phi=new Array(varCnt);this.bcType=new Array(varCnt);this.Ue=0;this.Uw=0;this.Vn=0;this.Vs=0;this.Ue_pseudo=0;this.Uw_pseudo=0;this.Vn_pseudo=0;this.Vs_pseudo=0;this.dx=0;this.dy=0;this.dx_w=0;this.dx_e=0;this.dy_n=0;this.dy_s=0;this.rho=0;this.rho_e=0;this.rho_w=0;this.rho_n=0;this.rho_s=0;this.gamma_n=0;this.gamma_s=0;this.gamma_e=0;this.gamma_w=0;this.netFlux=0;this.Se=0;this.Sw=0;this.Sn=0;this.Ss=0;this.Vol=0;this.Sc=0;this.Sp=0;this.ApplyBC1=ApplyBC1;this.CalcMatrics4UV=CalcMatrics4UV;this.CalcMatrics4RHS=CalcMatrics4RHS;this.PressureEval=PressureEval};function ApplyBC1(i,t){this.bcType[i]=1;this.aW=0;this.aE=0;this.aN=0;this.aS=0;this.aP=1;this.b[i]=t;this.phi[i]=t}function CalcMatrics4UV(i,t){if(this.bcType[i]==1)return;var s=this.gamma_e/this.dx_e*this.Se;var e=this.rho_e*this.Ue*this.Se;var n=e/s;this.aE=s*AFunc(n,HybridScheme)+Math.max(0,-e);var o=this.gamma_w/this.dx_w*this.Sw;var h=this.rho_w*this.Uw*this.Sw;var a=h/o;this.aW=o*AFunc(a,HybridScheme)+Math.max(0,h);var r=this.gamma_n/this.dy_n*this.Sn;var d=this.rho_n*this.Vn*this.Sn;var u=d/r;this.aN=r*AFunc(u,HybridScheme)+Math.max(0,-d);var p=this.gamma_s/this.dy_s*this.Ss;var l=this.rho_s*this.Vs*this.Ss;var m=l/p;this.aS=p*AFunc(m,HybridScheme)+Math.max(0,l);this.aP0=this.rho*this.Vol/t;this.netFlux=e-h+d-l;this.aP=this.aE+this.aW+this.aN+this.aS+this.aP0-this.Sp*this.Vol+this.netFlux}function CalcMatrics4RHS(i){if(this.bcType[i]==1)return;this.b[i]=this.Sc*this.Vol;this.b[i]+=this.aP0*this.phi[i];if(i==U)this.b[i]-=this.Pe*this.Se-this.Pw*this.Sw;if(i==V)this.b[i]-=this.Pn*this.Sn-this.Ps*this.Ss}function PressureEval(){var i=this.rho_e*this.Ue*this.Se;var t=this.rho_w*this.Uw*this.Sw;var s=this.rho_n*this.Vn*this.Sn;var e=this.rho_s*this.Vs*this.Ss;this.netFlux=i-t+s-e;this.phi[P]-=CXC*timeStep*this.netFlux/this.Vol}var Solution=function(i){if(i)this.nodes=i;else this.nodes=[];this.xDim=10;this.yDim=10;this.dx=1;this.dy=1;this.nodeNum=100;this.flowTime=0;this.SetUpGeometryAndMesh=SetUpGeometryAndMesh;this.indexFun=indexFun;this.idxFun=idxFun;this.ApplyMaterial=ApplyMaterial;this.SetUpBoundaryCondition=SetUpBoundaryCondition;this.SetUpBoundaryCondition4U=SetUpBoundaryCondition4U;this.SetUpBoundaryCondition4V=SetUpBoundaryCondition4V;this.Initialize=Initialize;this.CombineMatric4UV=CombineMatric4UV;this.CombineMatric4RHS=CombineMatric4RHS;this.InitialeUVface=InitialeUVface;this.CalcPface=CalcPface;this.CalcUV_pseudo=CalcUV_pseudo;this.CalcUVface=CalcUVface;this.CalcPressure=CalcPressure;this.Solve=Solve;this.SetUpInitialRoot=SetUpInitialRoot;this.SolveLinearEqByConjuageGradient=SolveLinearEqByConjuageGradient;this.CopyRoot=CopyRoot;this.GetContourData=GetContourData;this.GetContourElements=GetContourElements;this.ShowResults=ShowResults;this.ShowContour=ShowContour;this.printCoeffs=printCoeffs};function SetUpGeometryAndMesh(i,t,s,e){this.xDim=i+1;this.yDim=t+1;this.dx=s;this.dy=e;for(var n=0,o=0;o<i+3;o++){for(var h=0;h<t+3;h++){n=this.indexFun(o,h);nodes[n]=new Node2D((o-1)*s,(h-1)*e)}}this.nodeNum=nodes.length;for(var n=0,o=1;o<i+2;o++){for(var h=1;h<t+2;h++){n=this.indexFun(o,h);nodes[n].east=nodes[n+1];nodes[n].west=nodes[n-1];nodes[n].north=nodes[n+this.xDim+2];nodes[n].south=nodes[n-this.xDim-2];nodes[n].Vol=s*e*1;nodes[n].Se=e*1;nodes[n].Sw=e*1;nodes[n].Sn=s*1;nodes[n].Ss=s*1;nodes[n].dx_w=s;nodes[n].dx_e=s;nodes[n].dy_n=e;nodes[n].dy_s=e}}for(var o=1,h=1;h<t+2;h++){n=this.indexFun(o,h);nodes[n].Vol/=2;nodes[n].Sn/=2;nodes[n].Ss/=2;nodes[n].west=null}for(var o=i+1,h=1;h<t+2;h++){n=this.indexFun(o,h);nodes[n].Vol/=2;nodes[n].Sn/=2;nodes[n].Ss/=2;nodes[n].east=null}for(var h=1,o=1;o<i+2;o++){n=this.indexFun(o,h);nodes[n].Vol/=2;nodes[n].Se/=2;nodes[n].Sw/=2;nodes[n].south=null}for(var h=t+1,o=1;o<i+2;o++){n=this.indexFun(o,h);nodes[n].Vol/=2;nodes[n].Se/=2;nodes[n].Sw/=2;nodes[n].north=null}}function indexFun(i,t){return t*(this.xDim+2)+i}function idxFun(i,t,s){return(s-1)*i+t-1}function ApplyMaterial(i){for(var t=0;t<this.nodeNum;t++){nodes[t].rho=nodes[t].rho_e=nodes[t].rho_w=nodes[t].rho_n=nodes[t].rho_s=i.rho;nodes[t].gamma_e=nodes[t].gamma_w=nodes[t].gamma_n=nodes[t].gamma_s=i.viscosity}}function SetUpBoundaryCondition(){var i=1,t=1;var s=this.indexFun(i,t);nodes[s].ApplyBC1(P,0);this.SetUpBoundaryCondition4U();this.SetUpBoundaryCondition4V()}function SetUpBoundaryCondition4U(){var i=1,t=1,s=0;for(i=1,t=1;t<=this.yDim;t++){s=this.indexFun(i,t);nodes[s].ApplyBC1(U,0)}for(i=this.xDim,t=1;t<=this.yDim;t++){s=this.indexFun(i,t);nodes[s].ApplyBC1(U,0)}for(t=1,i=1;i<=this.xDim;i++){s=this.indexFun(i,t);nodes[s].ApplyBC1(U,0)}for(t=this.yDim,i=1;i<=this.xDim;i++){s=this.indexFun(i,t);nodes[s].ApplyBC1(U,1)}}function SetUpBoundaryCondition4V(){var i=1,t=1,s=0;for(i=1,t=1;t<=this.yDim;t++){s=this.indexFun(i,t);nodes[s].ApplyBC1(V,0)}for(i=this.xDim,t=1;t<=this.yDim;t++){s=this.indexFun(i,t);nodes[s].ApplyBC1(V,0)}for(t=1,i=1;i<=this.xDim;i++){s=this.indexFun(i,t);nodes[s].ApplyBC1(V,0)}for(t=this.yDim,i=1;i<=this.xDim;i++){s=this.indexFun(i,t);nodes[s].ApplyBC1(V,0)}}function Initialize(i){for(var t=0;t<this.nodeNum;t++){nodes[t].phi[U]=i.U;nodes[t].b[U]=0;nodes[t].phi[V]=i.V;nodes[t].b[V]=0;nodes[t].phi[P]=i.P;nodes[t].b[P]=0}this.CalcPface();this.InitialeUVface()}function InitialeUVface(){for(var i,t=0,s=1;s<=this.xDim;s++){for(var e=1;e<=this.yDim;e++){t=this.indexFun(s,e);i=nodes[t];i.Uw=i.west?(i.phi[U]+i.west.phi[U])/2:i.phi[U];i.Ue=i.east?(i.phi[U]+i.east.phi[U])/2:i.phi[U];i.Vn=i.north?(i.phi[V]+i.north.phi[V])/2:i.phi[V];i.Vs=i.south?(i.phi[V]+i.south.phi[V])/2:i.phi[V]}}}function CalcPface(){for(var i,t=0,s=1;s<=this.xDim;s++){for(var e=1;e<=this.yDim;e++){t=this.indexFun(s,e);i=nodes[t];i.Pw=i.west?(i.phi[P]+i.west.phi[P])/2:i.phi[P];i.Pe=i.east?(i.phi[P]+i.east.phi[P])/2:i.phi[P];i.Pn=i.north?(i.phi[P]+i.north.phi[P])/2:i.phi[P];i.Ps=i.south?(i.phi[P]+i.south.phi[P])/2:i.phi[P]}}}function CalcUV_pseudo(){for(var i,t=0,s=1;s<=this.xDim;s++){for(var e=1;e<=this.yDim;e++){t=this.indexFun(s,e);i=nodes[t];if(i.bcType[U]==1)i.phi[Upseudo]=i.phi[U];else i.phi[Upseudo]=i.phi[U]+(i.Pe-i.Pw)*i.Se/i.aP;if(i.bcType[V]==1)i.phi[Vpseudo]=i.phi[V];else i.phi[Vpseudo]=i.phi[V]+(i.Pn-i.Ps)*i.Sn/i.aP}}}function CalcUVface(){this.CalcPface();this.CalcUV_pseudo();for(var i,t=0,s=1;s<=this.xDim;s++){for(var e=1;e<=this.yDim;e++){t=this.indexFun(s,e);i=nodes[t];i.Ue_pseudo=i.east?(i.phi[Upseudo]+i.east.phi[Upseudo])/2:i.phi[Upseudo];i.Uw_pseudo=i.west?(i.phi[Upseudo]+i.west.phi[Upseudo])/2:i.phi[Upseudo];i.Vn_pseudo=i.north?(i.phi[Vpseudo]+i.north.phi[Vpseudo])/2:i.phi[Vpseudo];i.Vs_pseudo=i.south?(i.phi[Vpseudo]+i.south.phi[Vpseudo])/2:i.phi[Vpseudo]}}for(var i,n=0,t=0,s=2;s<=this.xDim-1;s++){for(var e=2;e<=this.yDim-1;e++){t=this.indexFun(s,e);i=nodes[t];n=(1/i.aP+1/i.east.aP)/2;i.Ue=i.Ue_pseudo-(i.east.phi[P]-i.phi[P])*i.Se*n;n=(1/i.aP+1/i.west.aP)/2;i.Uw=i.Uw_pseudo-(i.phi[P]-i.west.phi[P])*i.Sw*n;n=(1/i.aP+1/i.north.aP)/2;i.Vn=i.Vn_pseudo-(i.north.phi[P]-i.phi[P])*i.Sn*n;n=(1/i.aP+1/i.south.aP)/2;i.Vs=i.Vs_pseudo-(i.phi[P]-i.south.phi[P])*i.Ss*n}}}function CalcPressure(){var i=Number.MIN_VALUE;for(var t=0,s=1;s<=this.xDim;s++){for(var e=1;e<=this.yDim;e++){t=this.indexFun(s,e);nodes[t].PressureEval();if(i<nodes[t].netFlux)i=nodes[t].netFlux}}return i}function CombineMatric4UV(i,t){for(var s=0,e=1;e<=this.xDim;e++){for(var n=1;n<=this.yDim;n++){s=this.indexFun(e,n);nodes[s].CalcMatrics4UV(i,t)}}}function CombineMatric4RHS(i){for(var t=0,s=1;s<=this.xDim;s++){for(var e=1;e<=this.yDim;e++){t=this.indexFun(s,e);nodes[t].CalcMatrics4RHS(i)}}}function Solve(i,t){var s=this.xDim*this.yDim,e,n,o,h;var a=new Array(s);var r=new Array(s);mtx.Create(s);for(var d=0;d<i;d++){this.CombineMatric4UV(U,timeStep);this.SetUpBoundaryCondition4U();this.CombineMatric4RHS(U);this.SetUpInitialRoot(U,r);e=this.SolveLinearEqByConjuageGradient(a,r,U,false);this.CopyRoot(U,r);this.SetUpBoundaryCondition4V();this.CombineMatric4RHS(V);this.SetUpInitialRoot(V,r);n=this.SolveLinearEqByConjuageGradient(a,r,V,false);this.CopyRoot(V,r);this.CalcUVface();h=this.CalcPressure();rm.AddNewRes([e,n,o,h],d);console.log(d,"Residual-> Continuity:",h,"X-Vel:",e,"Y-Vel:",n,"Pres:",o)}}function SetUpInitialRoot(i,t){for(var s,e=1;e<=this.xDim;e++){for(var n=1;n<=this.yDim;n++){s=this.indexFun(e,n);idx=this.idxFun(this.xDim,e,n);t[idx]=nodes[s].phi[i]+Math.random()*1e-15}}}function SolveLinearEqByConjuageGradient(i,t,s,e){mtx.Erase(1);for(var n,o,h,a=1;a<=this.yDim;a++){for(var r=1;r<=this.xDim;r++){n=this.indexFun(r,a);h=nodes[n];o=this.idxFun(this.xDim,r,a);mtx.set(o,o,h.aP);mtx.set(o,o+1,-h.aE);mtx.set(o,o-1,-h.aW);mtx.set(o,o+this.xDim,-h.aN);mtx.set(o,o-this.xDim,-h.aS);i[o]=h.b[s]}}if(e)mtx.ShowSparseMatrix(i);return mtx.SolveByCG(i,t,1e-5)}function CopyRoot(i,t){for(var s,e=1;e<=this.xDim;e++){for(var n=1;n<=this.yDim;n++){s=this.indexFun(e,n);idx=this.idxFun(this.xDim,e,n);nodes[s].phi[i]=t[idx]}}}function GetContourElements(){for(var i=[],t=1;t<this.yDim;t++){for(var s=1;s<this.xDim;s++){var e=this.idxFun(this.xDim,s,t);var n=this.idxFun(this.xDim,s+1,t);var o=this.idxFun(this.xDim,s+1,t+1);var h=this.idxFun(this.xDim,s,t+1);var a=new Array(e,h,o);var r=new Array(e,o,n);i.push(new Elem(a,0),new Elem(r,0))}}return i}function GetContourData(i){for(var t=[],s,e,n=1;n<=this.yDim;n++){for(var o=1;o<=this.xDim;o++){e=this.indexFun(o,n);s=nodes[e];t.push(new XYZ(s.x,s.y,s.phi[i]))}}return t}function ShowResults(){function i(i){var t=250*i.x+110;var s=300-250*i.y-20;return new XYZ(t,s,0)}var t=this.GetContourElements();this.ShowContour("PContour",P,t,i);this.ShowContour("UContour",U,t,i);this.ShowContour("VContour",V,t,i);var s=new Complex,e=new Complex,n=20;var o=GetCanvasContext("PContour","2d");for(var h,a,r,d=1;d<=this.yDim;d++){for(var u=1;u<=this.xDim;u++){r=this.indexFun(u,d);a=nodes[r];h=i(a);s.x=h.x;s.y=h.y;e.x=a.phi[U]*n;e.y=-a.phi[V]*n;ContourUtil.DrawArrow(o,s,e)}}}function ShowContour(i,t,s,e){var n=GetCanvasContext(i,"2d");var o=this.GetContourData(t);var h=ContourUtil.SpawnValueKey(o,15);var a=ColorUtil.getLegendColor(h.length);ContourUtil.DrawLegend(n,h,2);ContourUtil.DrawAll(n,o,s,e,a,h,false);ContourUtil.ShowCoordnates(n,e,1,1,5,5)}var nodes=[],rm=null;var mtx=new SparseMatrix(1e-10);var timeStep=.1;function onSolve(){rm=new ResidualMonitor("ResiChart","Flow2D",500);rm.ShowLegend("legendResi");var i=new Solution(nodes);var t=25,s=1/t,e=25,n=1/e;i.SetUpGeometryAndMesh(t,e,s,n);var o=1,h=1;var a=new FluidMaterial(o,h);i.ApplyMaterial(a);i.Initialize({U:0,V:0,P:0});i.SetUpBoundaryCondition();var r=QueryPara("iteration")||500;i.Solve(r);i.ShowResults()}function main(){document.title=thisTitle;onSolve()}function AFunc(i,t){t=t||HybridScheme;i=Math.abs(i);switch(t){case HybridScheme:return Math.max(0,1-.5*i);case FirstOrderUpwindScheme:return 1;case PowerLawScheme:return Math.max(0,1-.1*Math.pow(i,5));case ExponentialScheme:return i/(Math.exp(i)-1);case CenteredDifferenceScheme:return 1-.5*i;default:break}return 0}function printCoeffs(i){var t=document.createElement("table");t.setAttribute("border","1");t.setAttribute("align","center");function s(i,t,s){var s=s=="td"?"td":"th";var e=document.createElement(s);e.innerHTML=t;i.appendChild(e)}var e=document.createElement("tr");s(e,"row","th");s(e,"col","th");s(e,"As","th");s(e,"Aw","th");s(e,"Ap","th");s(e,"Ae","th");s(e,"An","th");s(e,"b","th");s(e,"root","th");t.appendChild(e);for(var n,o,h,a=1;a<=this.xDim;a++){for(var r=1;r<=this.yDim;r++){var e=document.createElement("tr");n=this.idxFun(this.xDim,r,a);o=this.indexFun(r,a);h=nodes[o];s(e,a,"td");s(e,r,"td");s(e,h.aS.toFixed(1),"td");s(e,h.aW.toFixed(1),"td");s(e,h.aP.toFixed(1),"td");s(e,h.aE.toFixed(1),"td");s(e,h.aN.toFixed(1),"td");s(e,h.b.toFixed(1),"td");if(i)s(e,i[n],"td");t.appendChild(e)}}document.getElementById("bugInfoHost").appendChild(t)}			
		</script>
	</head>
	<body>
		<div style="width:500px; height:auto; float:left; display:inline">
		    <canvas id="PContour" width="550" height="400"></canvas>
		</div>
		<br>
		<div style="position:relative;width:500px; height:auto; float:left; display:inline">
		    <canvas id="ResiChart" width="500" height="400"></canvas>
		    <div style="position:absolute; top:0; left:0;">
		    	<p id="legendResi"> Legend </p>
		    </div>
		</div>
		<br>
		<div style="width:500px; height:auto; float:left; display:inline">
		    <canvas id="UContour" width="550" height="400"></canvas>
		</div>
		<div style="width:500px; height:auto; float:left; display:inline">
		    <canvas id="VContour" width="500" height="400"></canvas>
		</div>
		<br>
		<div id="bugInfoHost">
		</div>
		<br>
		<div style="width:500px; height:auto; float:left; display:inline">
			<script type="text/javascript" src="//rf.revolvermaps.com/0/0/7.js?i=58x4kn61rqm&amp;m=0&amp;c=ff0000&amp;cr1=ffffff&amp;sx=0" async="async"></script>
			<script>
				var _hmt = _hmt || [];
				(function() {
				  var hm = document.createElement("script");
				  hm.src = "https://hm.baidu.com/hm.js?c92893cdabb11ad8ca139c33152761e2";
				  var s = document.getElementsByTagName("script")[0]; 
				  s.parentNode.insertBefore(hm, s);
				})();
			</script>
		</div>
	</body>
</html>
